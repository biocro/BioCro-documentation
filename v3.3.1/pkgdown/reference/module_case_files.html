<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Define and modify BioCro module test case files — module_case_files • BioCro</title><!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Define and modify BioCro module test case files — module_case_files"><meta name="description" content="Test cases for testing modules can be stored in files. The functions
  here provide ways to create and update those files.
initialize_csv helps define test cases for module testing by
  initializing the csv file for one module based on either a set of
  default input values or user-supplied ones.
add_csv_row helps define test cases for module testing by adding one
  test case to a module's csv file based on the user-supplied inputs and
  description.
update_csv_cases helps define cases for module testing by updating the
  expected output values for each case stored in a module's csv file.
Note that module tests are distinct from the model tests
  described in model_testing."><meta property="og:description" content="Test cases for testing modules can be stored in files. The functions
  here provide ways to create and update those files.
initialize_csv helps define test cases for module testing by
  initializing the csv file for one module based on either a set of
  default input values or user-supplied ones.
add_csv_row helps define test cases for module testing by adding one
  test case to a module's csv file based on the user-supplied inputs and
  description.
update_csv_cases helps define cases for module testing by updating the
  expected output values for each case stored in a module's csv file.
Note that module tests are distinct from the model tests
  described in model_testing."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">BioCro</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">3.3.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../about_pkgdown_documentation.html">About</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><h6 class="dropdown-header" data-toc-skip>GENERAL BIOCRO USAGE</h6></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/BioCro.html">Getting Started with BioCro (HTML)</a></li>
    <li><a class="dropdown-item" href="../articles/web_only/workshop_I.pdf">Workshop I (PDF)</a></li>
    <li><a class="dropdown-item" href="../articles/web_only/a_practical_guide_to_biocro.pdf">A Practical Guide to BioCro (PDF)</a></li>
    <li><a class="dropdown-item" href="../articles/web_only/a_practical_guide_to_biocro.R">    [R code]</a></li>
    <li><a class="dropdown-item" href="../articles/web_only/quantitative_model_comparison.pdf">Quantitative Comparison Between Two Photosynthesis Models (PDF)</a></li>
    <li><a class="dropdown-item" href="../articles/web_only/quantitative_model_comparison.R">    [R code]</a></li>
    <li><a class="dropdown-item" href="../articles/web_only/BioCro-II_Paper--Section-1.1-example.html">BioCro II Paper: Section 1.1 Example (HTML)</a></li>
    <li><a class="dropdown-item" href="../articles/web_only/dynamical_systems.pdf">BioCro as a Dynamical System</a></li>
    <li><a class="dropdown-item" href="../articles/web_only/an_introduction_to_biocro.pdf">An Introduction to BioCro for Those Who Want to Add Models (PDF)</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>CROP GROWTH MODELING TOPICS</h6></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/web_only/thick_layer_absorption.html">Light Absorption by a Thick Layer (HTML)</a></li>
    <li><a class="dropdown-item" href="../articles/web_only/ball_berry_model.html">Using the Ball-Berry Model (HTML)</a></li>
    <li><a class="dropdown-item" href="../articles/web_only/canopy_photosynthesis.html">Multi-layer Canopy Photosynthesis Models (HTML)</a></li>
    <li><a class="dropdown-item" href="../articles/web_only/energy_balance.html">Energy Balance, Leaf Temperature, and Transpiration (HTML)</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../../bookdown/index.html">Developer's Manual</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-c-library" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">C++ Library</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-c-library"><li><a class="dropdown-item" href="../../doxygen/doxygen_docs_complete/index.html">Complete Doxygen Documentation</a></li>
    <li><a class="dropdown-item" href="../../doxygen/doxygen_docs_framework/index.html">Framework Documentation</a></li>
    <li><a class="dropdown-item" href="../../doxygen/doxygen_docs_modules/index.html">BioCro Module Documentation</a></li>
    <li><a class="dropdown-item" href="../../doxygen/doxygen_docs_modules_public_members_only/index.html">BioCro Module Documentation (public members only)</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/biocro/biocro/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Define and modify BioCro module test case files</h1>

      <div class="d-none name"><code>module_case_files.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Test cases for testing modules can be stored in files. The functions
  here provide ways to create and update those files.</p>
<p><code>initialize_csv</code> helps define test cases for module testing by
  initializing the <code>csv</code> file for one module based on either a set of
  default input values or user-supplied ones.</p>
<p><code>add_csv_row</code> helps define test cases for module testing by adding one
  test case to a module's <code>csv</code> file based on the user-supplied inputs and
  description.</p>
<p><code>update_csv_cases</code> helps define cases for module testing by updating the
  expected output values for each case stored in a module's csv file.</p>
<p>Note that <em>module tests</em> are distinct from the <em>model tests</em>
  described in <code><a href="model_testing.html">model_testing</a></code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">initialize_csv</span><span class="op">(</span></span>
<span>    <span class="va">module_name</span>,</span>
<span>    <span class="va">directory</span>,</span>
<span>    nonstandard_inputs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    description <span class="op">=</span> <span class="st">"automatically-generated test case"</span>,</span>
<span>    overwrite <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span>  <span class="fu">add_csv_row</span><span class="op">(</span><span class="va">module_name</span>, <span class="va">directory</span>, <span class="va">inputs</span>, <span class="va">description</span><span class="op">)</span></span>
<span></span>
<span>  <span class="fu">update_csv_cases</span><span class="op">(</span><span class="va">module_name</span>, <span class="va">directory</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <p></p>
<dl><dt id="arg-module-name">module_name<a class="anchor" aria-label="anchor" href="#arg-module-name"></a></dt>
<dd><p>A string specifying one BioCro module, formatted like
    <code>library_name:local_module_name</code>, where <code>library_name</code> is the name
    of a library that contains a module with local name
    <code>local_module_name</code>; such fully-qualified module names can be formed
    manually or with <code><a href="module_paste.html">module_paste</a></code>.</p></dd>


  <dt id="arg-directory">directory<a class="anchor" aria-label="anchor" href="#arg-directory"></a></dt>
<dd><p>The directory where module test case files are stored, e.g.
    <code>file.path('tests', 'module_test_cases')</code>.</p></dd>


  <dt id="arg-inputs">inputs<a class="anchor" aria-label="anchor" href="#arg-inputs"></a></dt>
<dd><p>A list of module inputs, i.e., a list of named numeric elements
    corresponding to the module's input quantities.</p></dd>


  <dt id="arg-description">description<a class="anchor" aria-label="anchor" href="#arg-description"></a></dt>
<dd><p>A string describing the test case, e.g. <code>"temp above tbase"</code>. The
    description should be succinct and not contain any newline characters.</p></dd>


  <dt id="arg-nonstandard-inputs">nonstandard_inputs<a class="anchor" aria-label="anchor" href="#arg-nonstandard-inputs"></a></dt>
<dd><p>An optional list of input quantities whose values will override the default
    value of 1.0; see the <code>inputs</code> entry above.</p></dd>


  <dt id="arg-overwrite">overwrite<a class="anchor" aria-label="anchor" href="#arg-overwrite"></a></dt>
<dd><p>A logical value indicating whether an existing file should be overwritten.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Module test case files form a critical component of BioCro's regression
  testing system. For more details, see the help page for
  <code><a href="module_testing.html">module_testing</a></code>.</p>
<p>The <code>initialize_csv</code> function will evaluate the module for a set of input
  quantities and store the results as a test case <code>csv</code> file. Typically,
  both of its optional arguments can be omitted. However, some modules produce
  errors when all inputs are set to 1.0. In this case, it would be necessary to
  supply some nonstandard inputs and (possibly) an alternate case description.</p>
<p>The <code>add_csv_row</code> function will evaluate the module for a set of input
  quantities, define a test case from the resulting outputs and the description,
  and add it to the module's corresponding <code>csv</code> file. If no <code>csv</code>
  file exists, one will be initialized with the new case.</p>
<p>The <code>update_csv_cases</code> function will evaluate the module for all input
  values specified in its <code>csv</code> case file and update the stored values of
  the corresponding outputs. Any output columns not present in the file will be
  added automatically and filled in with the correct values. Although the output
  columns are optional, the description column must exist in the <code>csv</code>
  file.</p>
<p>If a module test fails and <code>update_csv_cases</code> is used to update the test,
  care should be taken to ensure that the new outputs are sensible. This
  function should not be used to blindly ensure that tests pass, since a test
  failure may indicate a real problem with a module.</p>
<p>Note that <code>update_csv_cases</code> can be used to batch-initialize test cases.
  To do this, manually create a test case <code>csv</code> file with the proper name
  that only includes columns for the inputs and the description; now, calling
  <code>update_csv_cases</code> will automatically fill in the outputs for each case.
  With this method, care must be taken when manually specifying the values of
  the description column; the descriptions must be double quoted, and if they
  contain internal double quotes, those quotes must be doubled. Generally it is
  safest to simply avoid double quotes in the descriptions. (See <code>qmethod</code>
  in the help file for <code><a href="https://rdrr.io/r/utils/write.table.html" class="external-link">write.csv</a></code> for more details about quoting.)</p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A message indicating whether a file was created, overwritten, or not written.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p></p><ul><li><p><code><a href="modules.html">modules</a></code></p></li>
<li><p><code><a href="module_paste.html">module_paste</a></code></p></li>
<li><p><code><a href="module_testing.html">module_testing</a></code></p></li>
<li><p><code><a href="test_module_library.html">test_module_library</a></code></p></li>
<li><p><code><a href="test_module.html">test_module</a></code></p></li>
</ul></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># First, we will initialize a test case file for the 'BioCro' library's</span></span></span>
<span class="r-in"><span><span class="co"># 'thermal_time_linear' module, which will be saved in a temporary directory as</span></span></span>
<span class="r-in"><span><span class="co"># 'BioCro_thermal_time_linear.csv'. Then, we will add a new case to the file.</span></span></span>
<span class="r-in"><span><span class="co"># Finally, we will update the file. Note that the call to `update_csv_cases`</span></span></span>
<span class="r-in"><span><span class="co"># will not actually modify the file unless it is manually edited beforehand to</span></span></span>
<span class="r-in"><span><span class="co"># change an input or output value.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">td</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">initialize_csv</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="st">'BioCro:thermal_time_linear'</span>,</span></span>
<span class="r-in"><span>  <span class="va">td</span>,</span></span>
<span class="r-in"><span>  nonstandard_inputs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>temp <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  overwrite <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Case file `/tmp/Rtmp6yrElc/BioCro_thermal_time_linear.csv` was initialized; any pre-existing file was overwritten"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/writeLines.html" class="external-link">writeLines</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/readLines.html" class="external-link">readLines</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">td</span>, <span class="st">'BioCro_thermal_time_linear.csv'</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> input,input,input,input,output,"description"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> fractional_doy,sowing_fractional_doy,tbase,temp,TTc,NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1,1,1,-1,0,"automatically-generated test case"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">add_csv_row</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="st">'BioCro:thermal_time_linear'</span>,</span></span>
<span class="r-in"><span>  <span class="va">td</span>,</span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>fractional_doy <span class="op">=</span> <span class="fl">101</span>, sowing_fractional_doy <span class="op">=</span> <span class="fl">100</span>, tbase <span class="op">=</span> <span class="fl">20</span>, temp <span class="op">=</span> <span class="fl">44</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  <span class="st">'temp above tbase'</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Added new case to file `/tmp/Rtmp6yrElc/BioCro_thermal_time_linear.csv`"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/writeLines.html" class="external-link">writeLines</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/readLines.html" class="external-link">readLines</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">td</span>, <span class="st">'BioCro_thermal_time_linear.csv'</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> input,input,input,input,output,"description"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> fractional_doy,sowing_fractional_doy,tbase,temp,TTc,NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1,1,1,-1,0,"automatically-generated test case"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 101,100,20,44,1,"temp above tbase"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">update_csv_cases</span><span class="op">(</span><span class="st">'BioCro:thermal_time_linear'</span>, <span class="va">td</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Updated case file `/tmp/Rtmp6yrElc/BioCro_thermal_time_linear.csv`"</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Justin M. McGrath, Edward B. Lochocki, Yufeng He, Scott W. Oswald, Scott Rohde, Deepak Jaiswal, Megan L. Matthews, Fernando E. Miguez, Stephen P. Long.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

