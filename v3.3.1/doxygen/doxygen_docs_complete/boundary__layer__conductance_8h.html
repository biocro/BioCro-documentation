<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.4"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>The BioCro C++ Library: /github/workspace/src/module_library/boundary_layer_conductance.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">The BioCro C++ Library
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.4 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_567355a66c5b87dfe03a58cbdce72993.html">module_library</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">boundary_layer_conductance.h File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="closed.png" alt="+"/> This graph shows which files directly or indirectly include this file:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><img src="boundary__layer__conductance_8h__dep__incl.png" border="0" usemap="#a_2github_2workspace_2src_2module__library_2boundary__layer__conductance_8hdep" alt=""/></div>
<map name="a_2github_2workspace_2src_2module__library_2boundary__layer__conductance_8hdep" id="a_2github_2workspace_2src_2module__library_2boundary__layer__conductance_8hdep">
<area shape="rect" title=" " alt="" coords="499,5,665,61"/>
<area shape="rect" href="_aux_bio_cro_8cpp.html" title=" " alt="" coords="5,117,204,158"/>
<area shape="rect" href="boundary__layer__conductance_8cpp.html" title=" " alt="" coords="227,109,393,165"/>
<area shape="rect" href="canopy__gbw__thornley_8h.html" title=" " alt="" coords="417,109,571,165"/>
<area shape="rect" href="leaf__energy__balance_8cpp.html" title=" " alt="" coords="596,109,747,165"/>
<area shape="rect" href="leaf__gbw__campbell_8h.html" title=" " alt="" coords="771,109,921,165"/>
<area shape="rect" href="leaf__gbw__nikolov_8h.html" title=" " alt="" coords="945,109,1096,165"/>
<area shape="rect" href="module__library_8cpp.html" title=" " alt="" coords="769,213,923,269"/>
</map>
</div>
</div>
<p><a href="boundary__layer__conductance_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a31cde78d5dc4980def9a72de2b0a071b"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="boundary__layer__conductance_8h.html#a31cde78d5dc4980def9a72de2b0a071b">leaf_boundary_layer_conductance_campbell</a> (double air_temperature, double delta_t, double lw, double windspeed, double p)</td></tr>
<tr class="memdesc:a31cde78d5dc4980def9a72de2b0a071b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the conductance for water vapor flow from the leaf across its boundary layer using a model described in Campbell &amp; Norman (1998).  <a href="boundary__layer__conductance_8h.html#a31cde78d5dc4980def9a72de2b0a071b">More...</a><br /></td></tr>
<tr class="separator:a31cde78d5dc4980def9a72de2b0a071b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5331bdbcbe9b83bd3edb15bbea5df24d"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="boundary__layer__conductance_8h.html#a5331bdbcbe9b83bd3edb15bbea5df24d">leaf_boundary_layer_conductance_nikolov</a> (double air_temperature, double delta_t, double ea, double gsv, double lw, double windspeed, double p)</td></tr>
<tr class="memdesc:a5331bdbcbe9b83bd3edb15bbea5df24d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the conductance for water vapor flow from the leaf across its boundary layer using a model described in Nikolov, Massman, and Schoettle (1995).  <a href="boundary__layer__conductance_8h.html#a5331bdbcbe9b83bd3edb15bbea5df24d">More...</a><br /></td></tr>
<tr class="separator:a5331bdbcbe9b83bd3edb15bbea5df24d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8a0c037ff31b377084680a25728ed4ec"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="boundary__layer__conductance_8h.html#a8a0c037ff31b377084680a25728ed4ec">canopy_boundary_layer_conductance_thornley</a> (double CanopyHeight, double WindSpeed, double minimum_gbw, double WindSpeedHeight)</td></tr>
<tr class="memdesc:a8a0c037ff31b377084680a25728ed4ec"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the conductance for water vapor flow from the canopy across its boundary layer using a model described in Thornley and Johnson (1990).  <a href="boundary__layer__conductance_8h.html#a8a0c037ff31b377084680a25728ed4ec">More...</a><br /></td></tr>
<tr class="separator:a8a0c037ff31b377084680a25728ed4ec"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="a8a0c037ff31b377084680a25728ed4ec" name="a8a0c037ff31b377084680a25728ed4ec"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8a0c037ff31b377084680a25728ed4ec">&#9670;&nbsp;</a></span>canopy_boundary_layer_conductance_thornley()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double canopy_boundary_layer_conductance_thornley </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>CanopyHeight</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>WindSpeed</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>minimum_gbw</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>WindSpeedHeight</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates the conductance for water vapor flow from the canopy across its boundary layer using a model described in Thornley and Johnson (1990). </p>
<p >Note that when gas exchange is considered at the canopy level, this conductance characterizes the entire path to the ambient air. For a leaf within a canopy, there is an additional boundary layer separating the leaf from the canopy boundary layer; this leaf boundary layer conductance must be calculated using a separate model.</p>
<p >This model considers gas flow due to wind-driven eddy currents. Here, the conductance is calculated using Equation 14.9 from pages 414 - 416 of the Thornley textbook. Unfortunately, an electronic version of this reference is not available.</p>
<p >In this model, the minimum possible boundary layer conductance that could occur is zero, which would correspond to zero wind speed or canopy height. In realistic field conditions, boundary layer conductance can never truly be zero because of other transport processes such as buoyancy effects. To accomodate this, an option is provided for setting a minimum value for the boundary layer counductance.</p>
<p >This model contains two singularities, which occur when either of the following conditions are met:</p>
<ul>
<li><code>WindSpeedHeight + Zeta - d = 0</code>, which is equivalent to <code>CanopyHeight = WindSpeedHeight / (dCoef - ZetaCoef) = WindSpeedHeight * 1.34</code></li>
<li><code>WindSpeedHeight + ZetaM - d = 0</code>, which is equivalent to <code>CanopyHeight = WindSpeedHeight / (dCoef - ZetaMCoef) = WindSpeedHeight * 1.56</code></li>
</ul>
<p >So, as the canopy height approaches or exceeds the height at which wind speed was measured, the calculated boundary layer conductance becomes unbounded. For even larger canopy heights, the conductance eventually begins to decrease. For tall crops, this is a severe limitation to this model. Here we address this issue by limiting the canopy height to <code>0.98 * WindSpeedHeight</code>.</p>
<p >References:</p>
<ul>
<li>Thornley, J. H. M. &amp; Johnson, I. R. "Plant and Crop Modelling: A
  Mathematical Approach to Plant and Crop Physiology" (1990)</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">CanopyHeight</td><td>The height of the canopy above the ground in m</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">WindSpeed</td><td>The wind speed in m / s as measured above the canopy boundary layer</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">minimum_gbw</td><td>The lowest possible value for boundary layer conductance in m / s that should be returned</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">WindSpeedHeight</td><td>The height in m at which the wind speed was measured</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The canopy boundary layer conductance in m / s </dd></dl>

<p class="definition">Definition at line <a class="el" href="boundary__layer__conductance_8cpp_source.html#l00258">258</a> of file <a class="el" href="boundary__layer__conductance_8cpp_source.html">boundary_layer_conductance.cpp</a>.</p>

<p class="reference">Referenced by <a class="el" href="canopy__gbw__thornley_8h_source.html#l00069">canopy_gbw_thornley::do_operation()</a>, <a class="el" href="leaf__evapotranspiration_8h_source.html#l00124">leaf_evapotranspiration::do_operation()</a>, and <a class="el" href="leaf__evapotranspiration__check_8h_source.html#l00093">leaf_evapotranspiration_check::do_operation()</a>.</p>
<div id="dynsection-1" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-1-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-1-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-1-content" class="dyncontent" style="display:none;">
<div class="center"><img src="boundary__layer__conductance_8h_a8a0c037ff31b377084680a25728ed4ec_icgraph.png" border="0" usemap="#aboundary__layer__conductance_8h_a8a0c037ff31b377084680a25728ed4ec_icgraph" alt=""/></div>
<map name="aboundary__layer__conductance_8h_a8a0c037ff31b377084680a25728ed4ec_icgraph" id="aboundary__layer__conductance_8h_a8a0c037ff31b377084680a25728ed4ec_icgraph">
<area shape="rect" title="Calculates the conductance for water vapor flow from the canopy across its boundary layer using a mod..." alt="" coords="293,71,449,112"/>
<area shape="rect" href="classstandard_b_m_l_1_1canopy__gbw__thornley.html#a391e9fd4e949f6e987eb654a11b1e451" title=" " alt="" coords="33,5,218,47"/>
<area shape="rect" href="classstandard_b_m_l_1_1leaf__evapotranspiration.html#a391e9fd4e949f6e987eb654a11b1e451" title=" " alt="" coords="5,71,245,112"/>
<area shape="rect" href="classstandard_b_m_l_1_1leaf__evapotranspiration__check.html#a391e9fd4e949f6e987eb654a11b1e451" title=" " alt="" coords="5,136,245,177"/>
</map>
</div>

</div>
</div>
<a id="a31cde78d5dc4980def9a72de2b0a071b" name="a31cde78d5dc4980def9a72de2b0a071b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a31cde78d5dc4980def9a72de2b0a071b">&#9670;&nbsp;</a></span>leaf_boundary_layer_conductance_campbell()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double leaf_boundary_layer_conductance_campbell </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>air_temperature</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>delta_t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lw</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>windspeed</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>p</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates the conductance for water vapor flow from the leaf across its boundary layer using a model described in Campbell &amp; Norman (1998). </p>
<p >Note that for an isolated leaf, this conductance characterizes the entire path from the leaf surface to the ambient air. For a leaf within a canopy, there is an additional boundary layer separating the canopy from the atmosphere; this canopy boundary layer conductance must be calculated using a separate model.</p>
<p >In this model, two types of gas flow are considered: "forced" flow driven by wind-created eddy currents and "free" flow driven by temperature-related buoyancy effects. The overall conductance is determined to be the larger of the free and forced conductances.</p>
<p >In this function, we use the "forced convection" and "free convection" equations for vapor transfer as shown in Table 7.6. The equations as presented in the table return "molecular" conductances in units of mol / m^2 / s. Here we convert these to "mass" conductances for consistency with <code><a class="el" href="boundary__layer__conductance_8cpp.html#a5331bdbcbe9b83bd3edb15bbea5df24d" title="Calculates the conductance for water vapor flow from the leaf across its boundary layer using a model...">leaf_boundary_layer_conductance_nikolov()</a></code>.</p>
<p >These form a simpler alterative to the model presented in <code><a class="el" href="boundary__layer__conductance_8cpp.html#a5331bdbcbe9b83bd3edb15bbea5df24d" title="Calculates the conductance for water vapor flow from the leaf across its boundary layer using a model...">leaf_boundary_layer_conductance_nikolov()</a></code>. Specifically, the Campbell &amp; Norman equations do not require an iterative method to solve.</p>
<p >References:</p>
<ul>
<li>Campbell, G. S. &amp; Norman, J. "An Introduction to Environmental
  Biophysics," Springer-Verlag, New York, 1998</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">air_temperature</td><td>The air temperature in degrees C</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">delta_t</td><td>The temperature difference between the leaf and air in degrees C</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">lw</td><td>The characteristic leaf dimension in m</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">windspeed</td><td>The wind speed just outside the leaf boundary layer in m / s</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">p</td><td>The atmospheric pressure in Pa</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The leaf boundary layer conductance in m / s </dd></dl>

<p class="definition">Definition at line <a class="el" href="boundary__layer__conductance_8cpp_source.html#l00052">52</a> of file <a class="el" href="boundary__layer__conductance_8cpp_source.html">boundary_layer_conductance.cpp</a>.</p>

<p class="reference">References <a class="el" href="conductance__helpers_8h_source.html#l00047">g_to_mass()</a>.</p>

<p class="reference">Referenced by <a class="el" href="leaf__energy__balance_8cpp_source.html#l00048">calculate_gbw_leaf()</a>, and <a class="el" href="leaf__gbw__campbell_8h_source.html#l00073">leaf_gbw_campbell::do_operation()</a>.</p>
<div id="dynsection-2" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-2-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-2-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-2-content" class="dyncontent" style="display:none;">
<div class="center"><img src="boundary__layer__conductance_8h_a31cde78d5dc4980def9a72de2b0a071b_cgraph.png" border="0" usemap="#aboundary__layer__conductance_8h_a31cde78d5dc4980def9a72de2b0a071b_cgraph" alt=""/></div>
<map name="aboundary__layer__conductance_8h_a31cde78d5dc4980def9a72de2b0a071b_cgraph" id="aboundary__layer__conductance_8h_a31cde78d5dc4980def9a72de2b0a071b_cgraph">
<area shape="rect" title="Calculates the conductance for water vapor flow from the leaf across its boundary layer using a model..." alt="" coords="5,5,168,47"/>
<area shape="rect" href="conductance__helpers_8h.html#ac24f22e4807af1ee04f58b5fbfaeb968" title="Convert a conductance value from a &quot;molecular&quot; basis (in units of mol / m^2 / s) to a &quot;mass&quot; basis (i..." alt="" coords="216,13,303,39"/>
<area shape="rect" href="water__and__air__properties_8h.html#ae122b7938401239b4aca5917897190a6" title="Determine the volume of one mole of an ideal gas using the ideal gas law." alt="" coords="351,13,453,39"/>
</map>
</div>
<div id="dynsection-3" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-3-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-3-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-3-content" class="dyncontent" style="display:none;">
<div class="center"><img src="boundary__layer__conductance_8h_a31cde78d5dc4980def9a72de2b0a071b_icgraph.png" border="0" usemap="#aboundary__layer__conductance_8h_a31cde78d5dc4980def9a72de2b0a071b_icgraph" alt=""/></div>
<map name="aboundary__layer__conductance_8h_a31cde78d5dc4980def9a72de2b0a071b_icgraph" id="aboundary__layer__conductance_8h_a31cde78d5dc4980def9a72de2b0a071b_icgraph">
<area shape="rect" title="Calculates the conductance for water vapor flow from the leaf across its boundary layer using a model..." alt="" coords="1176,129,1339,171"/>
<area shape="rect" href="leaf__energy__balance_8cpp.html#a7c322870c21d6d88cf71efa151c815af" title="Calculates the leaf boundary layer conductance using the Nikolov model." alt="" coords="981,107,1114,134"/>
<area shape="rect" href="classstandard_b_m_l_1_1leaf__gbw__campbell.html#a391e9fd4e949f6e987eb654a11b1e451" title=" " alt="" coords="967,159,1128,200"/>
<area shape="rect" href="leaf__energy__balance_8cpp.html#a2b1477a27adac51f8d1c78748a2e25e9" title="Calculates a difference in leaf temperature; this function will return zero only if leaf temperature ..." alt="" coords="797,82,919,109"/>
<area shape="rect" href="leaf__energy__balance_8cpp.html#a55c7ef501ddb2ef2690b4edc80a6a697" title="Calculates leaf&#45;level temperature and transpiration rate for a leaf within a canopy using a Penman&#45;Mo..." alt="" coords="559,133,699,159"/>
<area shape="rect" href="classstandard_b_m_l_1_1leaf__evapotranspiration__check.html#a391e9fd4e949f6e987eb654a11b1e451" title=" " alt="" coords="509,67,749,108"/>
<area shape="rect" href="c3_can_a_c_8cpp.html#ab8cc082dfbf2c8485ef886bc2e92aa60" title=" " alt="" coords="303,17,380,43"/>
<area shape="rect" href="_can_a_c_8cpp.html#aaf84d24104310b21bc31529f9205df60" title=" " alt="" coords="310,74,373,101"/>
<area shape="rect" href="classstandard_b_m_l_1_1c3__leaf__photosynthesis.html#a391e9fd4e949f6e987eb654a11b1e451" title=" " alt="" coords="243,125,439,167"/>
<area shape="rect" href="classstandard_b_m_l_1_1c4__leaf__photosynthesis.html#a391e9fd4e949f6e987eb654a11b1e451" title=" " alt="" coords="243,191,439,232"/>
<area shape="rect" href="classstandard_b_m_l_1_1leaf__evapotranspiration.html#a391e9fd4e949f6e987eb654a11b1e451" title=" " alt="" coords="221,256,461,297"/>
<area shape="rect" href="classstandard_b_m_l_1_1c3__canopy.html#a391e9fd4e949f6e987eb654a11b1e451" title=" " alt="" coords="5,5,173,47"/>
<area shape="rect" href="classstandard_b_m_l_1_1c4__canopy.html#a391e9fd4e949f6e987eb654a11b1e451" title=" " alt="" coords="5,71,173,112"/>
</map>
</div>

</div>
</div>
<a id="a5331bdbcbe9b83bd3edb15bbea5df24d" name="a5331bdbcbe9b83bd3edb15bbea5df24d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5331bdbcbe9b83bd3edb15bbea5df24d">&#9670;&nbsp;</a></span>leaf_boundary_layer_conductance_nikolov()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double leaf_boundary_layer_conductance_nikolov </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>air_temperature</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>delta_t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>ea</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>gsv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lw</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>windspeed</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>p</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates the conductance for water vapor flow from the leaf across its boundary layer using a model described in Nikolov, Massman, and Schoettle (1995). </p>
<p >Note that for an isolated leaf, this conductance characterizes the entire path from the leaf surface to the ambient air. For a leaf within a canopy, there is an additional boundary layer separating the canopy from the atmosphere; this canopy boundary layer conductance must be calculated using a separate model.</p>
<p >In this model, two types of gas flow are considered: "forced" flow driven by wind-created eddy currents and "free" flow driven by temperature-related buoyancy effects. The overall conductance is determined to be the larger of the free and forced conductances.</p>
<p >In this function, we use equations 29, 33, 34, and 35 to calculate boundary layer conductance. This is the same approach taken in the <code>MLcan</code> model of Drewry et al. (2010).</p>
<p >Nikolov et al. (1995) solve the coupled equations for free boundary layer conductance using the fixed-point iteration method. Here we use the Dekker method for better stability.</p>
<p >Use this model with caution; it is know to exhibit multiple solutions, which can make its outputs discontinuous as inputs are varied.</p>
<p >References:</p>
<ul>
<li>[Nikolov, N. T., Massman, W. J. &amp; Schoettle, A. W. "Coupling biochemical and biophysical processes at the
  leaf level: an equilibrium photosynthesis model for leaves of C3 plants" Ecological Modelling 80, 205â€“235 (1995)] (<a href="https://doi.org/10.1016/0304-3800(94)00072-P">https://doi.org/10.1016/0304-3800(94)00072-P</a>)</li>
<li>[Drewry, D. T. et al. "Ecohydrological responses of dense canopies to environmental variability: 1. Interplay between
  vertical structure and photosynthetic pathway" Journal of Geophysical Research: Biogeosciences 115, (2010)] (<a href="https://doi.org/10.1029/2010JG001340">https://doi.org/10.1029/2010JG001340</a>)</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">air_temperature</td><td>The air temperature in degrees C</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">delta_t</td><td>The temperature difference between the leaf and air in degrees C</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ea</td><td>The partial pressure of water vapor in the atmosphere in Pa</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">gsv</td><td>The stomatal conductance in m / s</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">lw</td><td>The characteristic leaf dimension in m</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">windspeed</td><td>The wind speed just outside the leaf boundary layer in m / s</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">p</td><td>The atmospheric pressure in Pa</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The leaf boundary layer conductance in m / s </dd></dl>

<p class="definition">Definition at line <a class="el" href="boundary__layer__conductance_8cpp_source.html#l00130">130</a> of file <a class="el" href="boundary__layer__conductance_8cpp_source.html">boundary_layer_conductance.cpp</a>.</p>

<p class="reference">References <a class="el" href="constants_8h_source.html#l00032">conversion_constants::celsius_to_kelvin</a>, and <a class="el" href="water__and__air__properties_8h_source.html#l00058">saturation_vapor_pressure()</a>.</p>

<p class="reference">Referenced by <a class="el" href="leaf__gbw__nikolov_8h_source.html#l00080">leaf_gbw_nikolov::do_operation()</a>.</p>
<div id="dynsection-4" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-4-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-4-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-4-content" class="dyncontent" style="display:none;">
<div class="center"><img src="boundary__layer__conductance_8h_a5331bdbcbe9b83bd3edb15bbea5df24d_cgraph.png" border="0" usemap="#aboundary__layer__conductance_8h_a5331bdbcbe9b83bd3edb15bbea5df24d_cgraph" alt=""/></div>
<map name="aboundary__layer__conductance_8h_a5331bdbcbe9b83bd3edb15bbea5df24d_cgraph" id="aboundary__layer__conductance_8h_a5331bdbcbe9b83bd3edb15bbea5df24d_cgraph">
<area shape="rect" title="Calculates the conductance for water vapor flow from the leaf across its boundary layer using a model..." alt="" coords="5,5,156,47"/>
<area shape="rect" href="water__and__air__properties_8h.html#a117fba2c85ba6d52345e7cefc05a43ff" title="Determine saturation water vapor pressure (Pa) from air temperature (degrees C) using the Arden Buck ..." alt="" coords="204,13,379,39"/>
</map>
</div>
<div id="dynsection-5" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-5-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-5-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-5-content" class="dyncontent" style="display:none;">
<div class="center"><img src="boundary__layer__conductance_8h_a5331bdbcbe9b83bd3edb15bbea5df24d_icgraph.png" border="0" usemap="#aboundary__layer__conductance_8h_a5331bdbcbe9b83bd3edb15bbea5df24d_icgraph" alt=""/></div>
<map name="aboundary__layer__conductance_8h_a5331bdbcbe9b83bd3edb15bbea5df24d_icgraph" id="aboundary__layer__conductance_8h_a5331bdbcbe9b83bd3edb15bbea5df24d_icgraph">
<area shape="rect" title="Calculates the conductance for water vapor flow from the leaf across its boundary layer using a model..." alt="" coords="212,5,363,47"/>
<area shape="rect" href="classstandard_b_m_l_1_1leaf__gbw__nikolov.html#a391e9fd4e949f6e987eb654a11b1e451" title=" " alt="" coords="5,5,164,47"/>
</map>
</div>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon Feb 9 2026 17:59:06 for The BioCro C++ Library by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.4
</small></address>
</body>
</html>
