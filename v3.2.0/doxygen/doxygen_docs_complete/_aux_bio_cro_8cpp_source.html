<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.4"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>The BioCro C++ Library: /github/workspace/src/module_library/AuxBioCro.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">The BioCro C++ Library
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.4 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_567355a66c5b87dfe03a58cbdce72993.html">module_library</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle"><div class="title">AuxBioCro.cpp</div></div>
</div><!--header-->
<div class="contents">
<a href="_aux_bio_cro_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a id="l00001" name="l00001"></a><span class="lineno">    1</span><span class="comment">/* This file will contain functions which are common to several */</span></div>
<div class="line"><a id="l00002" name="l00002"></a><span class="lineno">    2</span><span class="comment">/* routines in the BioCro package. These are functions needed */</span></div>
<div class="line"><a id="l00003" name="l00003"></a><span class="lineno">    3</span><span class="comment">/* internally. The normal user will not need them */</span></div>
<div class="line"><a id="l00004" name="l00004"></a><span class="lineno">    4</span> </div>
<div class="line"><a id="l00005" name="l00005"></a><span class="lineno">    5</span><span class="preprocessor">#include &lt;string&gt;</span></div>
<div class="line"><a id="l00006" name="l00006"></a><span class="lineno">    6</span><span class="preprocessor">#include &lt;stdexcept&gt;</span>  <span class="comment">// for std::out_of_range, std::range_error</span></div>
<div class="line"><a id="l00007" name="l00007"></a><span class="lineno">    7</span><span class="preprocessor">#include &lt;algorithm&gt;</span>  <span class="comment">// for std::max, std::min</span></div>
<div class="line"><a id="l00008" name="l00008"></a><span class="lineno">    8</span><span class="preprocessor">#include &lt;cmath&gt;</span>      <span class="comment">// for exp, log, pow, lgamma, std::abs</span></div>
<div class="line"><a id="l00009" name="l00009"></a><span class="lineno">    9</span><span class="preprocessor">#include &lt;vector&gt;</span></div>
<div class="line"><a id="l00010" name="l00010"></a><span class="lineno">   10</span><span class="preprocessor">#include &quot;<a class="code" href="c4photo_8h.html">c4photo.h</a>&quot;</span></div>
<div class="line"><a id="l00011" name="l00011"></a><span class="lineno">   11</span><span class="preprocessor">#include &quot;<a class="code" href="_bio_cro_8h.html">BioCro.h</a>&quot;</span></div>
<div class="line"><a id="l00012" name="l00012"></a><span class="lineno">   12</span><span class="preprocessor">#include &quot;<a class="code" href="temperature__response__functions_8h.html">temperature_response_functions.h</a>&quot;</span>  <span class="comment">// for Q10_temperature_response</span></div>
<div class="line"><a id="l00013" name="l00013"></a><span class="lineno">   13</span><span class="preprocessor">#include &quot;<a class="code" href="boundary__layer__conductance_8h.html">boundary_layer_conductance.h</a>&quot;</span>      <span class="comment">// for leaf_boundary_layer_conductance_nikolov</span></div>
<div class="line"><a id="l00014" name="l00014"></a><span class="lineno">   14</span><span class="preprocessor">#include &quot;<a class="code" href="sun_m_l_8h.html">sunML.h</a>&quot;</span>                           <span class="comment">// for thick_layer_absorption</span></div>
<div class="line"><a id="l00015" name="l00015"></a><span class="lineno">   15</span><span class="preprocessor">#include &quot;<a class="code" href="water__and__air__properties_8h.html">water_and_air_properties.h</a>&quot;</span>        <span class="comment">// for saturation_vapor_pressure,</span></div>
<div class="line"><a id="l00016" name="l00016"></a><span class="lineno">   16</span>                                             <span class="comment">// TempToDdryA, TempToLHV, TempToSFS</span></div>
<div class="line"><a id="l00017" name="l00017"></a><span class="lineno">   17</span><span class="preprocessor">#include &quot;../framework/constants.h&quot;</span>          <span class="comment">// for pi, e, molar_mass_of_water,</span></div>
<div class="line"><a id="l00018" name="l00018"></a><span class="lineno">   18</span>                                             <span class="comment">// celsius_to_kelvin, stefan_boltzmann</span></div>
<div class="line"><a id="l00019" name="l00019"></a><span class="lineno">   19</span> </div>
<div class="line"><a id="l00020" name="l00020"></a><span class="lineno">   20</span><span class="keyword">using </span>std::vector;</div>
<div class="line"><a id="l00021" name="l00021"></a><span class="lineno">   21</span> </div>
<div class="line"><a id="l00022" name="l00022"></a><span class="lineno">   22</span><span class="comment">// The probability density for the Poisson distribution is</span></div>
<div class="line"><a id="l00023" name="l00023"></a><span class="lineno">   23</span><span class="comment">// e^(-lambda) * lambda^x / x!</span></div>
<div class="line"><a id="l00024" name="l00024"></a><span class="lineno">   24</span><span class="comment">//</span></div>
<div class="line"><a id="l00025" name="l00025"></a><span class="lineno">   25</span><span class="comment">// Both the numerator lambda^x and denominator x! can become very</span></div>
<div class="line"><a id="l00026" name="l00026"></a><span class="lineno">   26</span><span class="comment">// large, potentially causing numerical errors when calculating their</span></div>
<div class="line"><a id="l00027" name="l00027"></a><span class="lineno">   27</span><span class="comment">// ratio.</span></div>
<div class="line"><a id="l00028" name="l00028"></a><span class="lineno">   28</span><span class="comment">//</span></div>
<div class="line"><a id="l00029" name="l00029"></a><span class="lineno">   29</span><span class="comment">// In such cases, we take the log of the above expression to get</span></div>
<div class="line"><a id="l00030" name="l00030"></a><span class="lineno">   30</span><span class="comment">//</span></div>
<div class="line"><a id="l00031" name="l00031"></a><span class="lineno">   31</span><span class="comment">//   -lambda + (x * log(lambda)) - log(x!).</span></div>
<div class="line"><a id="l00032" name="l00032"></a><span class="lineno">   32</span><span class="comment">//</span></div>
<div class="line"><a id="l00033" name="l00033"></a><span class="lineno">   33</span><span class="comment">// We can obtain log(x!) using std::lgamma:</span></div>
<div class="line"><a id="l00034" name="l00034"></a><span class="lineno">   34</span><span class="comment">//</span></div>
<div class="line"><a id="l00035" name="l00035"></a><span class="lineno">   35</span><span class="comment">//   lgamma(x + 1) ~= log(x!)</span></div>
<div class="line"><a id="l00036" name="l00036"></a><span class="lineno">   36</span><span class="comment">//</span></div>
<div class="line"><a id="l00037" name="l00037"></a><span class="lineno">   37</span><span class="comment">// Then we return the result of applying exp to this.</span></div>
<div class="line"><a id="l00038" name="l00038"></a><span class="lineno">   38</span><span class="comment">//</span></div>
<div class="line"><a id="l00039" name="l00039"></a><span class="lineno"><a class="line" href="_aux_bio_cro_8cpp.html#add002b19ebc8390b467dd10c31bb2cb5">   39</a></span><span class="keywordtype">double</span> <a class="code hl_function" href="_aux_bio_cro_8cpp.html#add002b19ebc8390b467dd10c31bb2cb5">poisson_density</a>(<span class="keywordtype">int</span> x, <span class="keywordtype">double</span> lambda)</div>
<div class="line"><a id="l00040" name="l00040"></a><span class="lineno">   40</span>{</div>
<div class="line"><a id="l00041" name="l00041"></a><span class="lineno">   41</span>    <span class="comment">// Use lgamma to calculate the (log of) the factorial for large</span></div>
<div class="line"><a id="l00042" name="l00042"></a><span class="lineno">   42</span>    <span class="comment">// values of x:</span></div>
<div class="line"><a id="l00043" name="l00043"></a><span class="lineno">   43</span>    <span class="keywordflow">if</span> (x &gt; 10) {</div>
<div class="line"><a id="l00044" name="l00044"></a><span class="lineno">   44</span>        <span class="keywordtype">double</span> log_result = -lambda + x * log(lambda) - lgamma(x + 1);</div>
<div class="line"><a id="l00045" name="l00045"></a><span class="lineno">   45</span>        <span class="keywordflow">return</span> exp(log_result);</div>
<div class="line"><a id="l00046" name="l00046"></a><span class="lineno">   46</span>    }</div>
<div class="line"><a id="l00047" name="l00047"></a><span class="lineno">   47</span> </div>
<div class="line"><a id="l00048" name="l00048"></a><span class="lineno">   48</span>    <span class="comment">// Do closer to exact calculation for smaller x:</span></div>
<div class="line"><a id="l00049" name="l00049"></a><span class="lineno">   49</span>    <span class="keywordtype">double</span> factorial_x{1};</div>
<div class="line"><a id="l00050" name="l00050"></a><span class="lineno">   50</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt;= x; ++i) {</div>
<div class="line"><a id="l00051" name="l00051"></a><span class="lineno">   51</span>        factorial_x *= i;</div>
<div class="line"><a id="l00052" name="l00052"></a><span class="lineno">   52</span>    }</div>
<div class="line"><a id="l00053" name="l00053"></a><span class="lineno">   53</span> </div>
<div class="line"><a id="l00054" name="l00054"></a><span class="lineno">   54</span>    <span class="keywordflow">return</span> exp(-lambda) * pow(lambda, x) / factorial_x;</div>
<div class="line"><a id="l00055" name="l00055"></a><span class="lineno">   55</span>}</div>
<div class="line"><a id="l00056" name="l00056"></a><span class="lineno">   56</span> </div>
<div class="line"><a id="l00057" name="l00057"></a><span class="lineno">   57</span><span class="comment">/* Additional Functions needed for EvapoTrans */</span></div>
<div class="line"><a id="l00058" name="l00058"></a><span class="lineno">   58</span> </div>
<div class="line"><a id="l00067" name="l00067"></a><span class="lineno"><a class="line" href="_aux_bio_cro_8cpp.html#ac06a9906f486254d46a6838a86a52dcd">   67</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="_aux_bio_cro_8cpp.html#ac06a9906f486254d46a6838a86a52dcd">WINDprof</a>(<span class="keywordtype">double</span> WindSpeed, <span class="keywordtype">double</span> LAI, vector&lt;double&gt;&amp; wind_speed_profile)</div>
<div class="line"><a id="l00068" name="l00068"></a><span class="lineno">   68</span>{</div>
<div class="line"><a id="l00069" name="l00069"></a><span class="lineno">   69</span>    <span class="keyword">auto</span> nlayers = wind_speed_profile.size();</div>
<div class="line"><a id="l00070" name="l00070"></a><span class="lineno">   70</span>    <span class="keyword">constexpr</span> <span class="keywordtype">double</span> k = 0.7;</div>
<div class="line"><a id="l00071" name="l00071"></a><span class="lineno">   71</span>    <span class="keywordtype">double</span> LI = LAI / nlayers;</div>
<div class="line"><a id="l00072" name="l00072"></a><span class="lineno">   72</span> </div>
<div class="line"><a id="l00073" name="l00073"></a><span class="lineno">   73</span>    <span class="keywordflow">for</span> (vector&lt;double&gt;::size_type i = 0; i &lt; nlayers; ++i) {</div>
<div class="line"><a id="l00074" name="l00074"></a><span class="lineno">   74</span>        <span class="keywordtype">double</span> CumLAI = LI * (i + 1);</div>
<div class="line"><a id="l00075" name="l00075"></a><span class="lineno">   75</span>        wind_speed_profile[i] = WindSpeed * exp(-k * (CumLAI - LI));</div>
<div class="line"><a id="l00076" name="l00076"></a><span class="lineno">   76</span>    }</div>
<div class="line"><a id="l00077" name="l00077"></a><span class="lineno">   77</span>}</div>
<div class="line"><a id="l00078" name="l00078"></a><span class="lineno">   78</span> </div>
<div class="line"><a id="l00167" name="l00167"></a><span class="lineno"><a class="line" href="_aux_bio_cro_8cpp.html#aa4d2cdd07093428af4830f4c8afd660c">  167</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="_aux_bio_cro_8cpp.html#aa4d2cdd07093428af4830f4c8afd660c">RHprof</a>(<span class="keywordtype">double</span> RH, <span class="keywordtype">int</span> nlayers, <span class="keywordtype">double</span>* relative_humidity_profile)</div>
<div class="line"><a id="l00168" name="l00168"></a><span class="lineno">  168</span>{</div>
<div class="line"><a id="l00169" name="l00169"></a><span class="lineno">  169</span>    <span class="keywordflow">if</span> (RH &gt; 1 || RH &lt; 0) {</div>
<div class="line"><a id="l00170" name="l00170"></a><span class="lineno">  170</span>        <span class="keywordflow">throw</span> std::out_of_range(<span class="stringliteral">&quot;RH must be between 0 and 1.&quot;</span>);</div>
<div class="line"><a id="l00171" name="l00171"></a><span class="lineno">  171</span>    }</div>
<div class="line"><a id="l00172" name="l00172"></a><span class="lineno">  172</span>    <span class="keywordflow">if</span> (nlayers &lt; 1 || nlayers &gt; <a class="code hl_define" href="_aux_bio_cro_8h.html#a57179778cb6aed95fb9f484b55873d6f">MAXLAY</a>) {</div>
<div class="line"><a id="l00173" name="l00173"></a><span class="lineno">  173</span>        <span class="keywordflow">throw</span> std::out_of_range(<span class="stringliteral">&quot;nlayers must be at least 1 but no more than MAXLAY.&quot;</span>);</div>
<div class="line"><a id="l00174" name="l00174"></a><span class="lineno">  174</span>    }</div>
<div class="line"><a id="l00175" name="l00175"></a><span class="lineno">  175</span> </div>
<div class="line"><a id="l00176" name="l00176"></a><span class="lineno">  176</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> kh = 1 - RH;</div>
<div class="line"><a id="l00177" name="l00177"></a><span class="lineno">  177</span> </div>
<div class="line"><a id="l00178" name="l00178"></a><span class="lineno">  178</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; nlayers; ++i) {</div>
<div class="line"><a id="l00179" name="l00179"></a><span class="lineno">  179</span>        <span class="keywordtype">double</span> j = i + 1;  <span class="comment">// Explicitly make j a double so that j / nlayers isn&#39;t truncated.</span></div>
<div class="line"><a id="l00180" name="l00180"></a><span class="lineno">  180</span>        <span class="keywordtype">double</span> temp_rh = RH * exp(kh * (j / nlayers));</div>
<div class="line"><a id="l00181" name="l00181"></a><span class="lineno">  181</span>        relative_humidity_profile[i] = temp_rh;</div>
<div class="line"><a id="l00182" name="l00182"></a><span class="lineno">  182</span>    }</div>
<div class="line"><a id="l00183" name="l00183"></a><span class="lineno">  183</span>}</div>
<div class="line"><a id="l00184" name="l00184"></a><span class="lineno">  184</span> </div>
<div class="line"><a id="l00185" name="l00185"></a><span class="lineno"><a class="line" href="_aux_bio_cro_8cpp.html#a5f7c5a71f330ff99444aebac9e0538b3">  185</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="_aux_bio_cro_8cpp.html#a5f7c5a71f330ff99444aebac9e0538b3">LNprof</a>(<span class="keywordtype">double</span> LeafN, <span class="keywordtype">double</span> LAI, <span class="keywordtype">double</span> kpLN, vector&lt;double&gt;&amp; leafN_profile)</div>
<div class="line"><a id="l00186" name="l00186"></a><span class="lineno">  186</span>{</div>
<div class="line"><a id="l00187" name="l00187"></a><span class="lineno">  187</span>    <span class="keyword">auto</span> nlayers = leafN_profile.size();</div>
<div class="line"><a id="l00188" name="l00188"></a><span class="lineno">  188</span>    <span class="keywordtype">double</span> LI = LAI / nlayers;</div>
<div class="line"><a id="l00189" name="l00189"></a><span class="lineno">  189</span>    <span class="keywordflow">for</span> (vector&lt;double&gt;::size_type i = 0; i &lt; nlayers; ++i) {</div>
<div class="line"><a id="l00190" name="l00190"></a><span class="lineno">  190</span>        <span class="keywordtype">double</span> CumLAI = LI * (i + 1);</div>
<div class="line"><a id="l00191" name="l00191"></a><span class="lineno">  191</span>        leafN_profile[i] = LeafN * exp(-kpLN * (CumLAI - LI));</div>
<div class="line"><a id="l00192" name="l00192"></a><span class="lineno">  192</span>    }</div>
<div class="line"><a id="l00193" name="l00193"></a><span class="lineno">  193</span>}</div>
<div class="line"><a id="l00194" name="l00194"></a><span class="lineno">  194</span> </div>
<div class="line"><a id="l00195" name="l00195"></a><span class="lineno">  195</span><span class="comment">/* Soil Evaporation Function */</span></div>
<div class="line"><a id="l00196" name="l00196"></a><span class="lineno">  196</span><span class="comment">/* Variables I need */</span></div>
<div class="line"><a id="l00197" name="l00197"></a><span class="lineno">  197</span><span class="comment">/* LAI = Leaf Area Index */</span></div>
<div class="line"><a id="l00198" name="l00198"></a><span class="lineno">  198</span><span class="comment">/* k = extinction coefficient */</span></div>
<div class="line"><a id="l00199" name="l00199"></a><span class="lineno">  199</span><span class="comment">/* ppfd = Photosynthetic photon flux density */</span></div>
<div class="line"><a id="l00200" name="l00200"></a><span class="lineno">  200</span><span class="comment">/* awc, wiltp, fieldc = available water content, wilting point and field capacity */</span></div>
<div class="line"><a id="l00201" name="l00201"></a><span class="lineno">  201</span><span class="comment">/* winds = wind speed */</span></div>
<div class="line"><a id="l00202" name="l00202"></a><span class="lineno">  202</span> </div>
<div class="line"><a id="l00203" name="l00203"></a><span class="lineno"><a class="line" href="_aux_bio_cro_8cpp.html#ab163aedfdfb73c66e5eb8dca307016be">  203</a></span><span class="keywordtype">double</span> <a class="code hl_function" href="_aux_bio_cro_8cpp.html#ab163aedfdfb73c66e5eb8dca307016be">SoilEvapo</a>(</div>
<div class="line"><a id="l00204" name="l00204"></a><span class="lineno">  204</span>    <span class="keywordtype">double</span> LAI,</div>
<div class="line"><a id="l00205" name="l00205"></a><span class="lineno">  205</span>    <span class="keywordtype">double</span> k,</div>
<div class="line"><a id="l00206" name="l00206"></a><span class="lineno">  206</span>    <span class="keywordtype">double</span> air_temperature,</div>
<div class="line"><a id="l00207" name="l00207"></a><span class="lineno">  207</span>    <span class="keywordtype">double</span> ppfd,</div>
<div class="line"><a id="l00208" name="l00208"></a><span class="lineno">  208</span>    <span class="keywordtype">double</span> soil_water_content,</div>
<div class="line"><a id="l00209" name="l00209"></a><span class="lineno">  209</span>    <span class="keywordtype">double</span> fieldc,</div>
<div class="line"><a id="l00210" name="l00210"></a><span class="lineno">  210</span>    <span class="keywordtype">double</span> wiltp,</div>
<div class="line"><a id="l00211" name="l00211"></a><span class="lineno">  211</span>    <span class="keywordtype">double</span> winds,</div>
<div class="line"><a id="l00212" name="l00212"></a><span class="lineno">  212</span>    <span class="keywordtype">double</span> RelH,</div>
<div class="line"><a id="l00213" name="l00213"></a><span class="lineno">  213</span>    <span class="keywordtype">double</span> rsec,</div>
<div class="line"><a id="l00214" name="l00214"></a><span class="lineno">  214</span>    <span class="keywordtype">double</span> soil_clod_size,</div>
<div class="line"><a id="l00215" name="l00215"></a><span class="lineno">  215</span>    <span class="keywordtype">double</span> soil_reflectance,</div>
<div class="line"><a id="l00216" name="l00216"></a><span class="lineno">  216</span>    <span class="keywordtype">double</span> soil_transmission,</div>
<div class="line"><a id="l00217" name="l00217"></a><span class="lineno">  217</span>    <span class="keywordtype">double</span> specific_heat_of_air,</div>
<div class="line"><a id="l00218" name="l00218"></a><span class="lineno">  218</span>    <span class="keywordtype">double</span> par_energy_content)</div>
<div class="line"><a id="l00219" name="l00219"></a><span class="lineno">  219</span>{</div>
<div class="line"><a id="l00220" name="l00220"></a><span class="lineno">  220</span>    <span class="keywordtype">int</span> method = 1;</div>
<div class="line"><a id="l00221" name="l00221"></a><span class="lineno">  221</span> </div>
<div class="line"><a id="l00222" name="l00222"></a><span class="lineno">  222</span>    <span class="comment">// A simple way of calculating the proportion of the soil that is hit by</span></div>
<div class="line"><a id="l00223" name="l00223"></a><span class="lineno">  223</span>    <span class="comment">// direct radiation.</span></div>
<div class="line"><a id="l00224" name="l00224"></a><span class="lineno">  224</span>    <span class="keywordtype">double</span> soil_area_sunlit_fraction = exp(-k * LAI);  <span class="comment">// dimensionless.</span></div>
<div class="line"><a id="l00225" name="l00225"></a><span class="lineno">  225</span> </div>
<div class="line"><a id="l00226" name="l00226"></a><span class="lineno">  226</span>    <span class="comment">// For now the temperature of the soil will be the same as the air. At a</span></div>
<div class="line"><a id="l00227" name="l00227"></a><span class="lineno">  227</span>    <span class="comment">// later time this can be made more accurate. I looked at the equations for</span></div>
<div class="line"><a id="l00228" name="l00228"></a><span class="lineno">  228</span>    <span class="comment">// this and the issue is that it is strongly dependent on depth. Since the</span></div>
<div class="line"><a id="l00229" name="l00229"></a><span class="lineno">  229</span>    <span class="comment">// soil model now has a single layer, this cannot be implemented correctly</span></div>
<div class="line"><a id="l00230" name="l00230"></a><span class="lineno">  230</span>    <span class="comment">// at the moment.</span></div>
<div class="line"><a id="l00231" name="l00231"></a><span class="lineno">  231</span>    <span class="keywordtype">double</span> SoilTemp = air_temperature;</div>
<div class="line"><a id="l00232" name="l00232"></a><span class="lineno">  232</span> </div>
<div class="line"><a id="l00233" name="l00233"></a><span class="lineno">  233</span>    <span class="comment">/* From Campbell and Norman. Environmental Biophysics. */</span></div>
<div class="line"><a id="l00234" name="l00234"></a><span class="lineno">  234</span>    <span class="comment">/* If relative available water content is */</span></div>
<div class="line"><a id="l00235" name="l00235"></a><span class="lineno">  235</span>    <span class="keywordtype">double</span> rawc = (soil_water_content - wiltp) / (fieldc - wiltp);  <span class="comment">// dimensionless. relative available water content.</span></div>
<div class="line"><a id="l00236" name="l00236"></a><span class="lineno">  236</span> </div>
<div class="line"><a id="l00237" name="l00237"></a><span class="lineno">  237</span>    <span class="comment">/* Campbell and Norman. Environmental Physics, page 142 */</span></div>
<div class="line"><a id="l00238" name="l00238"></a><span class="lineno">  238</span>    <span class="keywordtype">double</span> maximum_uptake_rate = 1 - pow((1 + 1.3 * rawc), -5);  <span class="comment">// dimensionless</span></div>
<div class="line"><a id="l00239" name="l00239"></a><span class="lineno">  239</span>    <span class="comment">/* This is a useful idea because dry soils evaporate little water when dry*/</span></div>
<div class="line"><a id="l00240" name="l00240"></a><span class="lineno">  240</span> </div>
<div class="line"><a id="l00241" name="l00241"></a><span class="lineno">  241</span>    <span class="comment">// Total Radiation: At the moment soil evaporation is grossly overestimated.</span></div>
<div class="line"><a id="l00242" name="l00242"></a><span class="lineno">  242</span>    <span class="comment">// In WIMOVAC the light reaching the last layer of leaves is used. Here</span></div>
<div class="line"><a id="l00243" name="l00243"></a><span class="lineno">  243</span>    <span class="comment">// instead of calculating this again, I will for now assume a 10% as a rough</span></div>
<div class="line"><a id="l00244" name="l00244"></a><span class="lineno">  244</span>    <span class="comment">// estimate. Note that I could maybe get this since layIdir and layIDiff in</span></div>
<div class="line"><a id="l00245" name="l00245"></a><span class="lineno">  245</span>    <span class="comment">// sunML are external variables.  Rprintf(&quot;ppfd %.5f&quot;,layIdir[0],&quot;\n&quot;);</span></div>
<div class="line"><a id="l00246" name="l00246"></a><span class="lineno">  246</span>    <span class="comment">// Update: 03-13-2009. I tried printing this value but it is still too high</span></div>
<div class="line"><a id="l00247" name="l00247"></a><span class="lineno">  247</span>    <span class="comment">// and will likely overestimate soil evaporation. However, this is still a</span></div>
<div class="line"><a id="l00248" name="l00248"></a><span class="lineno">  248</span>    <span class="comment">// work in progress.</span></div>
<div class="line"><a id="l00249" name="l00249"></a><span class="lineno">  249</span>    ppfd *= rsec; <span class="comment">/* Radiation soil evaporation coefficient */</span></div>
<div class="line"><a id="l00250" name="l00250"></a><span class="lineno">  250</span> </div>
<div class="line"><a id="l00251" name="l00251"></a><span class="lineno">  251</span>    <span class="keywordtype">double</span> TotalRadiation = ppfd * par_energy_content;</div>
<div class="line"><a id="l00252" name="l00252"></a><span class="lineno">  252</span> </div>
<div class="line"><a id="l00253" name="l00253"></a><span class="lineno">  253</span>    <span class="keywordtype">double</span> DdryA = <a class="code hl_function" href="water__and__air__properties_8h.html#a6380d8cd4192408df76baefe6b369a70">TempToDdryA</a>(air_temperature);</div>
<div class="line"><a id="l00254" name="l00254"></a><span class="lineno">  254</span>    <span class="keywordtype">double</span> LHV = <a class="code hl_function" href="water__and__air__properties_8h.html#a460579178484521ecc50b488c58bb0dd">TempToLHV</a>(air_temperature);  <span class="comment">// J / kg</span></div>
<div class="line"><a id="l00255" name="l00255"></a><span class="lineno">  255</span>    <span class="keywordtype">double</span> SlopeFS = <a class="code hl_function" href="water__and__air__properties_8h.html#a05f381bbff6170709a8d0e2e34f4556a">TempToSFS</a>(air_temperature);</div>
<div class="line"><a id="l00256" name="l00256"></a><span class="lineno">  256</span>    <span class="keywordtype">double</span> SWVC = <a class="code hl_function" href="water__and__air__properties_8h.html#a117fba2c85ba6d52345e7cefc05a43ff">saturation_vapor_pressure</a>(air_temperature) * 1e-5;</div>
<div class="line"><a id="l00257" name="l00257"></a><span class="lineno">  257</span> </div>
<div class="line"><a id="l00258" name="l00258"></a><span class="lineno">  258</span>    <span class="keywordtype">double</span> PsycParam = (DdryA * specific_heat_of_air) / LHV;</div>
<div class="line"><a id="l00259" name="l00259"></a><span class="lineno">  259</span>    <span class="keywordtype">double</span> vapor_density_deficit = SWVC * (1 - RelH / 100);</div>
<div class="line"><a id="l00260" name="l00260"></a><span class="lineno">  260</span> </div>
<div class="line"><a id="l00261" name="l00261"></a><span class="lineno">  261</span>    <span class="keywordtype">double</span> BoundaryLayerThickness = 4e-3 * sqrt(soil_clod_size / winds);</div>
<div class="line"><a id="l00262" name="l00262"></a><span class="lineno">  262</span>    <span class="keywordtype">double</span> DiffCoef = 2.126e-5 + 1.48e-7 * SoilTemp;</div>
<div class="line"><a id="l00263" name="l00263"></a><span class="lineno">  263</span>    <span class="keywordtype">double</span> SoilBoundaryLayer = DiffCoef / BoundaryLayerThickness;</div>
<div class="line"><a id="l00264" name="l00264"></a><span class="lineno">  264</span> </div>
<div class="line"><a id="l00265" name="l00265"></a><span class="lineno">  265</span>    <span class="comment">// Here we calculate the total amount of PAR energy absorbed by the soil</span></div>
<div class="line"><a id="l00266" name="l00266"></a><span class="lineno">  266</span>    <span class="comment">// using `thick_layer_absorption`. We assume half of the solar energy lies</span></div>
<div class="line"><a id="l00267" name="l00267"></a><span class="lineno">  267</span>    <span class="comment">// in the PAR band, so we multiply by 2 to get the total absorbed solar</span></div>
<div class="line"><a id="l00268" name="l00268"></a><span class="lineno">  268</span>    <span class="comment">// energy. This is almost certainly untrue for light that has passed through</span></div>
<div class="line"><a id="l00269" name="l00269"></a><span class="lineno">  269</span>    <span class="comment">// a plant canopy.</span></div>
<div class="line"><a id="l00270" name="l00270"></a><span class="lineno">  270</span>    <span class="keywordtype">double</span> Ja = 2 * <a class="code hl_function" href="sun_m_l_8cpp.html#ab491bb8553ee710f275dbcd2b3e4547b">thick_layer_absorption</a>(</div>
<div class="line"><a id="l00271" name="l00271"></a><span class="lineno">  271</span>                        soil_reflectance,</div>
<div class="line"><a id="l00272" name="l00272"></a><span class="lineno">  272</span>                        soil_transmission,</div>
<div class="line"><a id="l00273" name="l00273"></a><span class="lineno">  273</span>                        TotalRadiation);</div>
<div class="line"><a id="l00274" name="l00274"></a><span class="lineno">  274</span> </div>
<div class="line"><a id="l00275" name="l00275"></a><span class="lineno">  275</span>    <span class="keywordtype">double</span> rlc = 4 * <a class="code hl_variable" href="namespacephysical__constants.html#ab993d2950483e6b20ca63c46f8134241">physical_constants::stefan_boltzmann</a> * pow((<a class="code hl_variable" href="namespaceconversion__constants.html#ac29e2ff8a2fe79bf1a6e7f5623f8f8a3">conversion_constants::celsius_to_kelvin</a> + SoilTemp), 3) * 0.005;</div>
<div class="line"><a id="l00276" name="l00276"></a><span class="lineno">  276</span>    <span class="comment">// The last term should be the difference between air temperature and soil.</span></div>
<div class="line"><a id="l00277" name="l00277"></a><span class="lineno">  277</span>    <span class="comment">// This is not actually calculated at the moment. Since this is mostly</span></div>
<div class="line"><a id="l00278" name="l00278"></a><span class="lineno">  278</span>    <span class="comment">// relevant to the first soil layer where the temperatures are similar. I</span></div>
<div class="line"><a id="l00279" name="l00279"></a><span class="lineno">  279</span>    <span class="comment">// will leave it like this for now.</span></div>
<div class="line"><a id="l00280" name="l00280"></a><span class="lineno">  280</span> </div>
<div class="line"><a id="l00281" name="l00281"></a><span class="lineno">  281</span>    <span class="keywordtype">double</span> PhiN = Ja - rlc; <span class="comment">/* Calculate the net radiation balance*/</span></div>
<div class="line"><a id="l00282" name="l00282"></a><span class="lineno">  282</span>    <span class="keywordflow">if</span> (PhiN &lt; 0) PhiN = 1e-7;</div>
<div class="line"><a id="l00283" name="l00283"></a><span class="lineno">  283</span> </div>
<div class="line"><a id="l00284" name="l00284"></a><span class="lineno">  284</span>    <span class="keywordtype">double</span> Evaporation = 0.0;</div>
<div class="line"><a id="l00285" name="l00285"></a><span class="lineno">  285</span>    <span class="keywordflow">if</span> (method == 0) {</div>
<div class="line"><a id="l00286" name="l00286"></a><span class="lineno">  286</span>        <span class="comment">/* Priestly-Taylor */</span></div>
<div class="line"><a id="l00287" name="l00287"></a><span class="lineno">  287</span>        Evaporation = 1.26 * (SlopeFS * PhiN) / (LHV * (SlopeFS + PsycParam));  <span class="comment">// kg / m^2 / s.</span></div>
<div class="line"><a id="l00288" name="l00288"></a><span class="lineno">  288</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00289" name="l00289"></a><span class="lineno">  289</span>        <span class="comment">/* Penman-Monteith */</span></div>
<div class="line"><a id="l00290" name="l00290"></a><span class="lineno">  290</span>        Evaporation = (SlopeFS * PhiN + LHV * PsycParam * SoilBoundaryLayer * vapor_density_deficit) / (LHV * (SlopeFS + PsycParam));  <span class="comment">// kg / m^2 / s.</span></div>
<div class="line"><a id="l00291" name="l00291"></a><span class="lineno">  291</span>    }</div>
<div class="line"><a id="l00292" name="l00292"></a><span class="lineno">  292</span> </div>
<div class="line"><a id="l00293" name="l00293"></a><span class="lineno">  293</span>    Evaporation *= soil_area_sunlit_fraction * maximum_uptake_rate;  <span class="comment">// kg / m^2 / s.</span></div>
<div class="line"><a id="l00294" name="l00294"></a><span class="lineno">  294</span>    <span class="keywordflow">if</span> (Evaporation &lt; 0) Evaporation = 1e-6;                         <span class="comment">// Prevent odd values at very low light levels.</span></div>
<div class="line"><a id="l00295" name="l00295"></a><span class="lineno">  295</span> </div>
<div class="line"><a id="l00296" name="l00296"></a><span class="lineno">  296</span>    <span class="keywordflow">return</span> Evaporation;  <span class="comment">// kg / m^2 / s.</span></div>
<div class="line"><a id="l00297" name="l00297"></a><span class="lineno">  297</span>}</div>
<div class="line"><a id="l00298" name="l00298"></a><span class="lineno">  298</span> </div>
<div class="line"><a id="l00299" name="l00299"></a><span class="lineno"><a class="line" href="_aux_bio_cro_8cpp.html#a058be0e6ed718b377d7c6056cceb09a8">  299</a></span><span class="keywordtype">double</span> <a class="code hl_function" href="_aux_bio_cro_8cpp.html#a058be0e6ed718b377d7c6056cceb09a8">compute_wsPhoto</a>(<span class="keywordtype">int</span> wsFun, <span class="keywordtype">double</span> fieldc, <span class="keywordtype">double</span> wiltp, <span class="keywordtype">double</span> phi1, <span class="keywordtype">double</span> awc)</div>
<div class="line"><a id="l00300" name="l00300"></a><span class="lineno">  300</span>{</div>
<div class="line"><a id="l00301" name="l00301"></a><span class="lineno">  301</span>    <span class="comment">// Three different type of equations for modeling the effect of</span></div>
<div class="line"><a id="l00302" name="l00302"></a><span class="lineno">  302</span>    <span class="comment">// water stress on vmax and leaf area expansion.  The equation for</span></div>
<div class="line"><a id="l00303" name="l00303"></a><span class="lineno">  303</span>    <span class="comment">// leaf area expansion is more severe than the one for vmax. */</span></div>
<div class="line"><a id="l00304" name="l00304"></a><span class="lineno">  304</span>    <span class="keywordtype">double</span> wsPhoto;</div>
<div class="line"><a id="l00305" name="l00305"></a><span class="lineno">  305</span>    <span class="keywordflow">switch</span> (wsFun) {</div>
<div class="line"><a id="l00306" name="l00306"></a><span class="lineno">  306</span>        <span class="keywordflow">case</span> 0: { <span class="comment">/* linear */</span></div>
<div class="line"><a id="l00307" name="l00307"></a><span class="lineno">  307</span>            <span class="keywordtype">double</span> slp = 1 / (fieldc - wiltp);</div>
<div class="line"><a id="l00308" name="l00308"></a><span class="lineno">  308</span>            <span class="keywordtype">double</span> intcpt = 1 - fieldc * slp;</div>
<div class="line"><a id="l00309" name="l00309"></a><span class="lineno">  309</span>            wsPhoto = slp * awc + intcpt;</div>
<div class="line"><a id="l00310" name="l00310"></a><span class="lineno">  310</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00311" name="l00311"></a><span class="lineno">  311</span>        }</div>
<div class="line"><a id="l00312" name="l00312"></a><span class="lineno">  312</span>        <span class="keywordflow">case</span> 1: {</div>
<div class="line"><a id="l00313" name="l00313"></a><span class="lineno">  313</span>            <span class="keywordtype">double</span> phi10 = (fieldc + wiltp) / 2;</div>
<div class="line"><a id="l00314" name="l00314"></a><span class="lineno">  314</span>            wsPhoto = 1 / (1 + exp((phi10 - awc) / phi1));</div>
<div class="line"><a id="l00315" name="l00315"></a><span class="lineno">  315</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00316" name="l00316"></a><span class="lineno">  316</span>        }</div>
<div class="line"><a id="l00317" name="l00317"></a><span class="lineno">  317</span>        <span class="keywordflow">case</span> 2: {</div>
<div class="line"><a id="l00318" name="l00318"></a><span class="lineno">  318</span>            <span class="keywordtype">double</span> slp = (1 - wiltp) / (fieldc - wiltp);</div>
<div class="line"><a id="l00319" name="l00319"></a><span class="lineno">  319</span>            <span class="keywordtype">double</span> intcpt = 1 - fieldc * slp;</div>
<div class="line"><a id="l00320" name="l00320"></a><span class="lineno">  320</span>            <span class="keywordtype">double</span> theta = slp * awc + intcpt;</div>
<div class="line"><a id="l00321" name="l00321"></a><span class="lineno">  321</span>            wsPhoto = (1 - exp(-2.5 * (theta - wiltp) / (1 - wiltp))) / (1 - exp(-2.5));</div>
<div class="line"><a id="l00322" name="l00322"></a><span class="lineno">  322</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00323" name="l00323"></a><span class="lineno">  323</span>        }</div>
<div class="line"><a id="l00324" name="l00324"></a><span class="lineno">  324</span>        <span class="keywordflow">case</span> 3:</div>
<div class="line"><a id="l00325" name="l00325"></a><span class="lineno">  325</span>            wsPhoto = 1;</div>
<div class="line"><a id="l00326" name="l00326"></a><span class="lineno">  326</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00327" name="l00327"></a><span class="lineno">  327</span>        <span class="keywordflow">default</span>:</div>
<div class="line"><a id="l00328" name="l00328"></a><span class="lineno">  328</span>            wsPhoto = 0;</div>
<div class="line"><a id="l00329" name="l00329"></a><span class="lineno">  329</span>    }</div>
<div class="line"><a id="l00330" name="l00330"></a><span class="lineno">  330</span> </div>
<div class="line"><a id="l00331" name="l00331"></a><span class="lineno">  331</span>    <span class="comment">// wsPhoto can be mathematically lower than zero in some cases but</span></div>
<div class="line"><a id="l00332" name="l00332"></a><span class="lineno">  332</span>    <span class="comment">// I should prevent that:</span></div>
<div class="line"><a id="l00333" name="l00333"></a><span class="lineno">  333</span>    <span class="keywordflow">if</span> (wsPhoto &lt;= 0) {</div>
<div class="line"><a id="l00334" name="l00334"></a><span class="lineno">  334</span>        wsPhoto = 1e-10;</div>
<div class="line"><a id="l00335" name="l00335"></a><span class="lineno">  335</span>    }</div>
<div class="line"><a id="l00336" name="l00336"></a><span class="lineno">  336</span> </div>
<div class="line"><a id="l00337" name="l00337"></a><span class="lineno">  337</span>    <span class="comment">// Apparently wsPhoto can be greater than 1.</span></div>
<div class="line"><a id="l00338" name="l00338"></a><span class="lineno">  338</span>    <span class="keywordflow">if</span> (wsPhoto &gt; 1) wsPhoto = 1;</div>
<div class="line"><a id="l00339" name="l00339"></a><span class="lineno">  339</span> </div>
<div class="line"><a id="l00340" name="l00340"></a><span class="lineno">  340</span>    <span class="keywordflow">return</span> wsPhoto;</div>
<div class="line"><a id="l00341" name="l00341"></a><span class="lineno">  341</span>}</div>
<div class="line"><a id="l00342" name="l00342"></a><span class="lineno">  342</span> </div>
<div class="line"><a id="l00343" name="l00343"></a><span class="lineno">  343</span><span class="comment">/* This is a new function that attempts to keep a water budget and then</span></div>
<div class="line"><a id="l00344" name="l00344"></a><span class="lineno">  344</span><span class="comment">   calcualte an empirical coefficient that reduces the specific leaf area.</span></div>
<div class="line"><a id="l00345" name="l00345"></a><span class="lineno">  345</span><span class="comment">   This results from the general idea that water stress reduces first the</span></div>
<div class="line"><a id="l00346" name="l00346"></a><span class="lineno">  346</span><span class="comment">   rate of leaf expansion. */</span></div>
<div class="line"><a id="l00347" name="l00347"></a><span class="lineno">  347</span> </div>
<div class="line"><a id="l00348" name="l00348"></a><span class="lineno">  348</span><span class="comment">/* This is meant to be a simple function that calculates a</span></div>
<div class="line"><a id="l00349" name="l00349"></a><span class="lineno">  349</span><span class="comment">   simple empirical coefficient that reduces specifi leaf area</span></div>
<div class="line"><a id="l00350" name="l00350"></a><span class="lineno">  350</span><span class="comment">   according to the water stress of the plant. This is done</span></div>
<div class="line"><a id="l00351" name="l00351"></a><span class="lineno">  351</span><span class="comment">   for now, with a very simple empirical approach. */</span></div>
<div class="line"><a id="l00352" name="l00352"></a><span class="lineno">  352</span> </div>
<div class="line"><a id="l00353" name="l00353"></a><span class="lineno"><a class="line" href="_aux_bio_cro_8cpp.html#afd82d6a23b65b58f4b7652dc9c8146c3">  353</a></span><a class="code hl_struct" href="structws__str.html">ws_str</a> <a class="code hl_function" href="_aux_bio_cro_8cpp.html#afd82d6a23b65b58f4b7652dc9c8146c3">watstr</a>(</div>
<div class="line"><a id="l00354" name="l00354"></a><span class="lineno">  354</span>    <span class="keywordtype">double</span> precipit,</div>
<div class="line"><a id="l00355" name="l00355"></a><span class="lineno">  355</span>    <span class="keywordtype">double</span> evapo,</div>
<div class="line"><a id="l00356" name="l00356"></a><span class="lineno">  356</span>    <span class="keywordtype">double</span> cws,</div>
<div class="line"><a id="l00357" name="l00357"></a><span class="lineno">  357</span>    <span class="keywordtype">double</span> soildepth,</div>
<div class="line"><a id="l00358" name="l00358"></a><span class="lineno">  358</span>    <span class="keywordtype">double</span> fieldc,</div>
<div class="line"><a id="l00359" name="l00359"></a><span class="lineno">  359</span>    <span class="keywordtype">double</span> wiltp,</div>
<div class="line"><a id="l00360" name="l00360"></a><span class="lineno">  360</span>    <span class="keywordtype">double</span> soil_saturation_capacity,</div>
<div class="line"><a id="l00361" name="l00361"></a><span class="lineno">  361</span>    <span class="keywordtype">double</span> sand,</div>
<div class="line"><a id="l00362" name="l00362"></a><span class="lineno">  362</span>    <span class="keywordtype">double</span> Ks,</div>
<div class="line"><a id="l00363" name="l00363"></a><span class="lineno">  363</span>    <span class="keywordtype">double</span> air_entry,</div>
<div class="line"><a id="l00364" name="l00364"></a><span class="lineno">  364</span>    <span class="keywordtype">double</span> b)</div>
<div class="line"><a id="l00365" name="l00365"></a><span class="lineno">  365</span>{</div>
<div class="line"><a id="l00366" name="l00366"></a><span class="lineno">  366</span>    <span class="keyword">constexpr</span> <span class="keywordtype">double</span> g = 9.8;  <span class="comment">// m / s^2  ##  http://en.wikipedia.org/wiki/Standard_gravity</span></div>
<div class="line"><a id="l00367" name="l00367"></a><span class="lineno">  367</span> </div>
<div class="line"><a id="l00368" name="l00368"></a><span class="lineno">  368</span>    <span class="keywordtype">double</span> precipM = precipit * 1e-3;                        <span class="comment">/* convert precip in mm to m*/</span></div>
<div class="line"><a id="l00369" name="l00369"></a><span class="lineno">  369</span>    <span class="keywordtype">double</span> soil_water_fraction = precipM / soildepth + cws;  <span class="comment">// m^3 m^-3</span></div>
<div class="line"><a id="l00370" name="l00370"></a><span class="lineno">  370</span> </div>
<div class="line"><a id="l00371" name="l00371"></a><span class="lineno">  371</span>    <span class="keywordtype">double</span> runoff = 0.0;</div>
<div class="line"><a id="l00372" name="l00372"></a><span class="lineno">  372</span>    <span class="keywordtype">double</span> Nleach = 0.0; <span class="comment">/* Nleach is the NO3 leached. */</span></div>
<div class="line"><a id="l00373" name="l00373"></a><span class="lineno">  373</span> </div>
<div class="line"><a id="l00374" name="l00374"></a><span class="lineno">  374</span>    <span class="keywordflow">if</span> (soil_water_fraction &gt; soil_saturation_capacity) {</div>
<div class="line"><a id="l00375" name="l00375"></a><span class="lineno">  375</span>        runoff = (soil_water_fraction - soil_saturation_capacity) * soildepth; <span class="comment">/* This is in meters */</span></div>
<div class="line"><a id="l00376" name="l00376"></a><span class="lineno">  376</span>        <span class="comment">/* Here runoff is interpreted as water content exceeding saturation level */</span></div>
<div class="line"><a id="l00377" name="l00377"></a><span class="lineno">  377</span>        <span class="comment">/* Need to convert to units used in the Parton et al 1988 paper. */</span></div>
<div class="line"><a id="l00378" name="l00378"></a><span class="lineno">  378</span>        <span class="comment">/* The data come in mm/hr and need to be in cm/month */</span></div>
<div class="line"><a id="l00379" name="l00379"></a><span class="lineno">  379</span>        Nleach = runoff / (1e3 * <a class="code hl_variable" href="namespacephysical__constants.html#a7162c8c2c8cfdb894219fadabc0a764c">physical_constants::molar_mass_of_water</a>) * (0.2 + 0.7 * sand);</div>
<div class="line"><a id="l00380" name="l00380"></a><span class="lineno">  380</span>        soil_water_fraction = soil_saturation_capacity;</div>
<div class="line"><a id="l00381" name="l00381"></a><span class="lineno">  381</span>    }</div>
<div class="line"><a id="l00382" name="l00382"></a><span class="lineno">  382</span> </div>
<div class="line"><a id="l00383" name="l00383"></a><span class="lineno">  383</span>    <span class="comment">/* The density of water is 0.9982 Mg / m^3 at 20 degrees Celsius. */</span></div>
<div class="line"><a id="l00384" name="l00384"></a><span class="lineno">  384</span>    <span class="comment">/* evapo is demanded water (Mg / ha) */</span></div>
<div class="line"><a id="l00385" name="l00385"></a><span class="lineno">  385</span>    <span class="keywordtype">double</span> npaw = soil_water_fraction - wiltp - evapo / 0.9982 / 1e4 / soildepth;  <span class="comment">// fraction of saturation.</span></div>
<div class="line"><a id="l00386" name="l00386"></a><span class="lineno">  386</span> </div>
<div class="line"><a id="l00387" name="l00387"></a><span class="lineno">  387</span>    <span class="comment">/* If demand exceeds supply, the crop is getting close to wilting point and transpiration</span></div>
<div class="line"><a id="l00388" name="l00388"></a><span class="lineno">  388</span><span class="comment">       will be over estimated. In this one layer model though, the crop is practically dead. */</span></div>
<div class="line"><a id="l00389" name="l00389"></a><span class="lineno">  389</span>    <span class="keywordflow">if</span> (npaw &lt; 0) npaw = 0.0;</div>
<div class="line"><a id="l00390" name="l00390"></a><span class="lineno">  390</span>    <span class="keywordtype">double</span> awc = npaw + wiltp;</div>
<div class="line"><a id="l00391" name="l00391"></a><span class="lineno">  391</span> </div>
<div class="line"><a id="l00392" name="l00392"></a><span class="lineno">  392</span>    <span class="comment">/* Calculating the soil water potential based on equations from Norman and Campbell */</span></div>
<div class="line"><a id="l00393" name="l00393"></a><span class="lineno">  393</span>    <span class="comment">/* tmp.psim = soTexS.air_entry * pow((awc/soTexS.fieldc*1.1),-soTexS.b); */</span></div>
<div class="line"><a id="l00394" name="l00394"></a><span class="lineno">  394</span>    <span class="comment">/* New version of the soil water potential is based on</span></div>
<div class="line"><a id="l00395" name="l00395"></a><span class="lineno">  395</span><span class="comment">     * &quot;Dynamic Simulation of Water Deficit Effects upon Maize Yield&quot; R. F. Grant Agricultural Systems. 33(1990) 13-39. */</span></div>
<div class="line"><a id="l00396" name="l00396"></a><span class="lineno">  396</span>    <a class="code hl_struct" href="structws__str.html">ws_str</a> tmp;</div>
<div class="line"><a id="l00397" name="l00397"></a><span class="lineno">  397</span>    tmp.<a class="code hl_variable" href="structws__str.html#ac2f458ad74016a5af57f18d9774bb0d9">psim</a> = -exp(log(0.033) + (log(fieldc) - log(awc)) / (log(fieldc) - log(wiltp)) * (log(1.5) - log(0.033))) * 1e3; <span class="comment">/* This last term converts from MPa to kPa */</span></div>
<div class="line"><a id="l00398" name="l00398"></a><span class="lineno">  398</span> </div>
<div class="line"><a id="l00399" name="l00399"></a><span class="lineno">  399</span>    <span class="comment">/* This is drainage */</span></div>
<div class="line"><a id="l00400" name="l00400"></a><span class="lineno">  400</span>    <span class="keywordflow">if</span> (awc &gt; fieldc) {</div>
<div class="line"><a id="l00401" name="l00401"></a><span class="lineno">  401</span>        <span class="keywordtype">double</span> K_psim = Ks * pow((air_entry / tmp.<a class="code hl_variable" href="structws__str.html#ac2f458ad74016a5af57f18d9774bb0d9">psim</a>), 2 + 3 / b); <span class="comment">/* This is hydraulic conductivity */</span></div>
<div class="line"><a id="l00402" name="l00402"></a><span class="lineno">  402</span> </div>
<div class="line"><a id="l00403" name="l00403"></a><span class="lineno">  403</span>        <span class="comment">// Campbell, pg 129 do not ignore the graviational effect. I multiply</span></div>
<div class="line"><a id="l00404" name="l00404"></a><span class="lineno">  404</span>        <span class="comment">// soil depth by 0.5 to calculate the average depth.</span></div>
<div class="line"><a id="l00405" name="l00405"></a><span class="lineno">  405</span>        <span class="keywordtype">double</span> J_w = -K_psim * (-tmp.<a class="code hl_variable" href="structws__str.html#ac2f458ad74016a5af57f18d9774bb0d9">psim</a> / (soildepth * 0.5)) - g * K_psim;</div>
<div class="line"><a id="l00406" name="l00406"></a><span class="lineno">  406</span> </div>
<div class="line"><a id="l00407" name="l00407"></a><span class="lineno">  407</span>        <span class="keywordtype">double</span> drainage = J_w * 3600 * 0.9982 * 1e-3; <span class="comment">/* This is flow in m^3 / (m^2 * hr). */</span></div>
<div class="line"><a id="l00408" name="l00408"></a><span class="lineno">  408</span>        awc = awc + drainage / soildepth;</div>
<div class="line"><a id="l00409" name="l00409"></a><span class="lineno">  409</span>    }</div>
<div class="line"><a id="l00410" name="l00410"></a><span class="lineno">  410</span> </div>
<div class="line"><a id="l00411" name="l00411"></a><span class="lineno">  411</span>    tmp.<a class="code hl_variable" href="structws__str.html#aa293628634276d793267cbf2542ce2e2">awc</a> = awc;</div>
<div class="line"><a id="l00412" name="l00412"></a><span class="lineno">  412</span>    tmp.<a class="code hl_variable" href="structws__str.html#a365dc60f2331a4280fc2be55b822191c">runoff</a> = runoff;</div>
<div class="line"><a id="l00413" name="l00413"></a><span class="lineno">  413</span>    tmp.<a class="code hl_variable" href="structws__str.html#a26953bee326ec08f079e24838fc8feb6">Nleach</a> = Nleach;</div>
<div class="line"><a id="l00414" name="l00414"></a><span class="lineno">  414</span>    <span class="keywordflow">return</span> tmp;</div>
<div class="line"><a id="l00415" name="l00415"></a><span class="lineno">  415</span>}</div>
<div class="line"><a id="l00416" name="l00416"></a><span class="lineno">  416</span> </div>
<div class="line"><a id="l00417" name="l00417"></a><span class="lineno">  417</span><span class="comment">/* Function to simulate the multilayer behavior of soil water. In the</span></div>
<div class="line"><a id="l00418" name="l00418"></a><span class="lineno">  418</span><span class="comment">   future this could be coupled with Campbell (BASIC) ideas to</span></div>
<div class="line"><a id="l00419" name="l00419"></a><span class="lineno">  419</span><span class="comment">   esitmate water potential. */</span></div>
<div class="line"><a id="l00420" name="l00420"></a><span class="lineno"><a class="line" href="_aux_bio_cro_8cpp.html#a7f7b8457e2206d31608f20cc696341b7">  420</a></span><a class="code hl_struct" href="structsoil_m_l__str.html">soilML_str</a> <a class="code hl_function" href="_aux_bio_cro_8cpp.html#a7f7b8457e2206d31608f20cc696341b7">soilML</a>(</div>
<div class="line"><a id="l00421" name="l00421"></a><span class="lineno">  421</span>    <span class="keywordtype">double</span> precipit,</div>
<div class="line"><a id="l00422" name="l00422"></a><span class="lineno">  422</span>    <span class="keywordtype">double</span> transp,</div>
<div class="line"><a id="l00423" name="l00423"></a><span class="lineno">  423</span>    <span class="keywordtype">double</span>* cws,</div>
<div class="line"><a id="l00424" name="l00424"></a><span class="lineno">  424</span>    <span class="keywordtype">double</span> soildepth,</div>
<div class="line"><a id="l00425" name="l00425"></a><span class="lineno">  425</span>    <span class="keywordtype">double</span>* depths,</div>
<div class="line"><a id="l00426" name="l00426"></a><span class="lineno">  426</span>    <span class="keywordtype">double</span> soil_field_capacity,</div>
<div class="line"><a id="l00427" name="l00427"></a><span class="lineno">  427</span>    <span class="keywordtype">double</span> soil_wilting_point,</div>
<div class="line"><a id="l00428" name="l00428"></a><span class="lineno">  428</span>    <span class="keywordtype">double</span> soil_saturation_capacity,</div>
<div class="line"><a id="l00429" name="l00429"></a><span class="lineno">  429</span>    <span class="keywordtype">double</span> soil_air_entry,</div>
<div class="line"><a id="l00430" name="l00430"></a><span class="lineno">  430</span>    <span class="keywordtype">double</span> soil_saturated_conductivity,</div>
<div class="line"><a id="l00431" name="l00431"></a><span class="lineno">  431</span>    <span class="keywordtype">double</span> soil_b_coefficient,</div>
<div class="line"><a id="l00432" name="l00432"></a><span class="lineno">  432</span>    <span class="keywordtype">double</span> soil_sand_content,</div>
<div class="line"><a id="l00433" name="l00433"></a><span class="lineno">  433</span>    <span class="keywordtype">double</span> phi1,</div>
<div class="line"><a id="l00434" name="l00434"></a><span class="lineno">  434</span>    <span class="keywordtype">double</span> phi2,</div>
<div class="line"><a id="l00435" name="l00435"></a><span class="lineno">  435</span>    <span class="keywordtype">int</span> wsFun,</div>
<div class="line"><a id="l00436" name="l00436"></a><span class="lineno">  436</span>    <span class="keywordtype">int</span> layers,</div>
<div class="line"><a id="l00437" name="l00437"></a><span class="lineno">  437</span>    <span class="keywordtype">double</span> rootDB,</div>
<div class="line"><a id="l00438" name="l00438"></a><span class="lineno">  438</span>    <span class="keywordtype">double</span> LAI,</div>
<div class="line"><a id="l00439" name="l00439"></a><span class="lineno">  439</span>    <span class="keywordtype">double</span> k,</div>
<div class="line"><a id="l00440" name="l00440"></a><span class="lineno">  440</span>    <span class="keywordtype">double</span> AirTemp,</div>
<div class="line"><a id="l00441" name="l00441"></a><span class="lineno">  441</span>    <span class="keywordtype">double</span> IRad,</div>
<div class="line"><a id="l00442" name="l00442"></a><span class="lineno">  442</span>    <span class="keywordtype">double</span> winds,</div>
<div class="line"><a id="l00443" name="l00443"></a><span class="lineno">  443</span>    <span class="keywordtype">double</span> RelH,</div>
<div class="line"><a id="l00444" name="l00444"></a><span class="lineno">  444</span>    <span class="keywordtype">int</span> hydrDist,</div>
<div class="line"><a id="l00445" name="l00445"></a><span class="lineno">  445</span>    <span class="keywordtype">double</span> rfl,</div>
<div class="line"><a id="l00446" name="l00446"></a><span class="lineno">  446</span>    <span class="keywordtype">double</span> rsec,</div>
<div class="line"><a id="l00447" name="l00447"></a><span class="lineno">  447</span>    <span class="keywordtype">double</span> rsdf,</div>
<div class="line"><a id="l00448" name="l00448"></a><span class="lineno">  448</span>    <span class="keywordtype">double</span> soil_clod_size,</div>
<div class="line"><a id="l00449" name="l00449"></a><span class="lineno">  449</span>    <span class="keywordtype">double</span> soil_reflectance,</div>
<div class="line"><a id="l00450" name="l00450"></a><span class="lineno">  450</span>    <span class="keywordtype">double</span> soil_transmission,</div>
<div class="line"><a id="l00451" name="l00451"></a><span class="lineno">  451</span>    <span class="keywordtype">double</span> specific_heat_of_air,</div>
<div class="line"><a id="l00452" name="l00452"></a><span class="lineno">  452</span>    <span class="keywordtype">double</span> par_energy_content)</div>
<div class="line"><a id="l00453" name="l00453"></a><span class="lineno">  453</span>{</div>
<div class="line"><a id="l00454" name="l00454"></a><span class="lineno">  454</span>    <span class="keyword">constexpr</span> <span class="keywordtype">double</span> g = 9.8; <span class="comment">/* m / s-2  ##  http://en.wikipedia.org/wiki/Standard_gravity */</span></div>
<div class="line"><a id="l00455" name="l00455"></a><span class="lineno">  455</span> </div>
<div class="line"><a id="l00456" name="l00456"></a><span class="lineno">  456</span>    <a class="code hl_struct" href="structsoil_m_l__str.html">soilML_str</a> return_value;</div>
<div class="line"><a id="l00457" name="l00457"></a><span class="lineno">  457</span> </div>
<div class="line"><a id="l00458" name="l00458"></a><span class="lineno">  458</span>    <span class="comment">/* Crude empirical relationship between root biomass and rooting depth*/</span></div>
<div class="line"><a id="l00459" name="l00459"></a><span class="lineno">  459</span>    <span class="keywordtype">double</span> rootDepth = fmin(rootDB * rsdf, soildepth);</div>
<div class="line"><a id="l00460" name="l00460"></a><span class="lineno">  460</span> </div>
<div class="line"><a id="l00461" name="l00461"></a><span class="lineno">  461</span>    <a class="code hl_struct" href="structrd__str.html">rd_str</a> root_distribution = <a class="code hl_function" href="_aux_bio_cro_8cpp.html#afc92a0998ee191ec72b256ad232804c9">rootDist</a>(layers, rootDepth, &amp;depths[0], rfl);</div>
<div class="line"><a id="l00462" name="l00462"></a><span class="lineno">  462</span> </div>
<div class="line"><a id="l00463" name="l00463"></a><span class="lineno">  463</span>    <span class="comment">/* unit conversion for precip */</span></div>
<div class="line"><a id="l00464" name="l00464"></a><span class="lineno">  464</span>    <span class="keywordtype">double</span> oldWaterIn = 0.0;</div>
<div class="line"><a id="l00465" name="l00465"></a><span class="lineno">  465</span>    <span class="keywordtype">double</span> waterIn = precipit * 1e-3; <span class="comment">/* convert precip in mm to m */</span></div>
<div class="line"><a id="l00466" name="l00466"></a><span class="lineno">  466</span> </div>
<div class="line"><a id="l00467" name="l00467"></a><span class="lineno">  467</span>    <span class="keywordtype">double</span> drainage = 0.0;</div>
<div class="line"><a id="l00468" name="l00468"></a><span class="lineno">  468</span>    <span class="keywordtype">double</span> wsPhotoCol = 0.0;</div>
<div class="line"><a id="l00469" name="l00469"></a><span class="lineno">  469</span>    <span class="keywordtype">double</span> LeafWSCol = 0.0;</div>
<div class="line"><a id="l00470" name="l00470"></a><span class="lineno">  470</span>    <span class="keywordtype">double</span> Sevap = 0.0;</div>
<div class="line"><a id="l00471" name="l00471"></a><span class="lineno">  471</span>    <span class="keywordtype">double</span> oldEvapoTra = 0.0;</div>
<div class="line"><a id="l00472" name="l00472"></a><span class="lineno">  472</span> </div>
<div class="line"><a id="l00473" name="l00473"></a><span class="lineno">  473</span>    <span class="comment">// The counter, i, decreases because I increase the water content due to</span></div>
<div class="line"><a id="l00474" name="l00474"></a><span class="lineno">  474</span>    <span class="comment">// precipitation in the last layer first</span></div>
<div class="line"><a id="l00475" name="l00475"></a><span class="lineno">  475</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = layers - 1; i &gt;= 0; --i) {</div>
<div class="line"><a id="l00476" name="l00476"></a><span class="lineno">  476</span>        <span class="keywordtype">double</span> layerDepth = depths[i + 1] - depths[i]; <span class="comment">/* This supports unequal depths. */</span></div>
<div class="line"><a id="l00477" name="l00477"></a><span class="lineno">  477</span> </div>
<div class="line"><a id="l00478" name="l00478"></a><span class="lineno">  478</span>        <span class="keywordflow">if</span> (hydrDist &gt; 0) {</div>
<div class="line"><a id="l00479" name="l00479"></a><span class="lineno">  479</span>            <span class="comment">/* For this section see Campbell and Norman &quot;Environmental BioPhysics&quot; Chapter 9*/</span></div>
<div class="line"><a id="l00480" name="l00480"></a><span class="lineno">  480</span>            <span class="comment">/* First compute the matric potential */</span></div>
<div class="line"><a id="l00481" name="l00481"></a><span class="lineno">  481</span>            <span class="keywordtype">double</span> psim1 = soil_air_entry * pow((cws[i] / soil_saturation_capacity), -soil_b_coefficient); <span class="comment">/* This is matric potential of current layer */</span></div>
<div class="line"><a id="l00482" name="l00482"></a><span class="lineno">  482</span>            <span class="keywordtype">double</span> dPsim;</div>
<div class="line"><a id="l00483" name="l00483"></a><span class="lineno">  483</span>            <span class="keywordflow">if</span> (i &gt; 0) {</div>
<div class="line"><a id="l00484" name="l00484"></a><span class="lineno">  484</span>                <span class="keywordtype">double</span> psim2 = soil_air_entry * pow((cws[i - 1] / soil_saturation_capacity), -soil_b_coefficient); <span class="comment">/* This is matric potential of next layer */</span></div>
<div class="line"><a id="l00485" name="l00485"></a><span class="lineno">  485</span>                dPsim = psim1 - psim2;</div>
<div class="line"><a id="l00486" name="l00486"></a><span class="lineno">  486</span>                <span class="comment">// The substraction is from the layer i - (i-1). If this last</span></div>
<div class="line"><a id="l00487" name="l00487"></a><span class="lineno">  487</span>                <span class="comment">// term is positive then it will move upwards. If it is negative</span></div>
<div class="line"><a id="l00488" name="l00488"></a><span class="lineno">  488</span>                <span class="comment">// it will move downwards. Presumably this term is almost always</span></div>
<div class="line"><a id="l00489" name="l00489"></a><span class="lineno">  489</span>                <span class="comment">// positive.</span></div>
<div class="line"><a id="l00490" name="l00490"></a><span class="lineno">  490</span>            } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00491" name="l00491"></a><span class="lineno">  491</span>                dPsim = 0.0;</div>
<div class="line"><a id="l00492" name="l00492"></a><span class="lineno">  492</span>            }</div>
<div class="line"><a id="l00493" name="l00493"></a><span class="lineno">  493</span> </div>
<div class="line"><a id="l00494" name="l00494"></a><span class="lineno">  494</span>            <span class="keywordtype">double</span> K_psim = soil_saturated_conductivity * pow((soil_air_entry / psim1), 2 + 3 / soil_b_coefficient); <span class="comment">/* This is hydraulic conductivity */</span></div>
<div class="line"><a id="l00495" name="l00495"></a><span class="lineno">  495</span>            <span class="keywordtype">double</span> J_w = K_psim * (dPsim / layerDepth) - g * K_psim;                                                 <span class="comment">/*  Campbell, pg 129 do not ignore the graviational effect*/</span></div>
<div class="line"><a id="l00496" name="l00496"></a><span class="lineno">  496</span>            <span class="comment">/* Notice that K_psim is positive because my reference system is reversed */</span></div>
<div class="line"><a id="l00497" name="l00497"></a><span class="lineno">  497</span>            <span class="comment">/* This last result should be in kg/(m2 * s) */</span></div>
<div class="line"><a id="l00498" name="l00498"></a><span class="lineno">  498</span>            J_w *= 3600 * 0.9882 * 1e-3; <span class="comment">/* This is flow in m3 / (m^2 * hr). */</span></div>
<div class="line"><a id="l00499" name="l00499"></a><span class="lineno">  499</span> </div>
<div class="line"><a id="l00500" name="l00500"></a><span class="lineno">  500</span>            <span class="keywordflow">if</span> (i == (layers - 1) &amp;&amp; J_w &lt; 0) {</div>
<div class="line"><a id="l00501" name="l00501"></a><span class="lineno">  501</span>                <span class="comment">/* cws[i] = cws[i] + J_w / layerDepth; Although this should be done it drains the last layer too much.*/</span></div>
<div class="line"><a id="l00502" name="l00502"></a><span class="lineno">  502</span>                drainage += J_w;</div>
<div class="line"><a id="l00503" name="l00503"></a><span class="lineno">  503</span>            } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00504" name="l00504"></a><span class="lineno">  504</span>                cws[i] = cws[i] - J_w / layerDepth;</div>
<div class="line"><a id="l00505" name="l00505"></a><span class="lineno">  505</span>                <span class="keywordflow">if</span> (i &gt; 0) {</div>
<div class="line"><a id="l00506" name="l00506"></a><span class="lineno">  506</span>                    cws[i - 1] = cws[i - 1] + J_w / layerDepth;</div>
<div class="line"><a id="l00507" name="l00507"></a><span class="lineno">  507</span>                }</div>
<div class="line"><a id="l00508" name="l00508"></a><span class="lineno">  508</span>            }</div>
<div class="line"><a id="l00509" name="l00509"></a><span class="lineno">  509</span>        }</div>
<div class="line"><a id="l00510" name="l00510"></a><span class="lineno">  510</span> </div>
<div class="line"><a id="l00511" name="l00511"></a><span class="lineno">  511</span>        <span class="keywordflow">if</span> (cws[i] &gt; soil_saturation_capacity) cws[i] = soil_saturation_capacity;</div>
<div class="line"><a id="l00512" name="l00512"></a><span class="lineno">  512</span>        <span class="keywordflow">if</span> (cws[i] &lt; soil_wilting_point) cws[i] = soil_wilting_point;</div>
<div class="line"><a id="l00513" name="l00513"></a><span class="lineno">  513</span>        <span class="comment">// Here is a convention aw is available water in volume and awc</span></div>
<div class="line"><a id="l00514" name="l00514"></a><span class="lineno">  514</span>        <span class="comment">// is available water content as a fraction of the soil section being investigated.</span></div>
<div class="line"><a id="l00515" name="l00515"></a><span class="lineno">  515</span>        <span class="keywordtype">double</span> aw = cws[i] * layerDepth;</div>
<div class="line"><a id="l00516" name="l00516"></a><span class="lineno">  516</span>        <span class="comment">/* Available water (for this layer) is the current water status times the layer depth */</span></div>
<div class="line"><a id="l00517" name="l00517"></a><span class="lineno">  517</span> </div>
<div class="line"><a id="l00518" name="l00518"></a><span class="lineno">  518</span>        <span class="keywordflow">if</span> (waterIn &gt; 0) {</div>
<div class="line"><a id="l00519" name="l00519"></a><span class="lineno">  519</span>            <span class="comment">/* There is some rain. Need to add it.*/</span></div>
<div class="line"><a id="l00520" name="l00520"></a><span class="lineno">  520</span>            aw += waterIn / layers + oldWaterIn; <span class="comment">/* They are both in meters so it works */</span></div>
<div class="line"><a id="l00521" name="l00521"></a><span class="lineno">  521</span>            <span class="comment">/* Adding the same amount to water to each layer */</span></div>
<div class="line"><a id="l00522" name="l00522"></a><span class="lineno">  522</span>            <span class="comment">/* In case there is overflow */</span></div>
<div class="line"><a id="l00523" name="l00523"></a><span class="lineno">  523</span>            <span class="keywordtype">double</span> diffw = soil_field_capacity * layerDepth - aw;</div>
<div class="line"><a id="l00524" name="l00524"></a><span class="lineno">  524</span> </div>
<div class="line"><a id="l00525" name="l00525"></a><span class="lineno">  525</span>            <span class="keywordflow">if</span> (diffw &lt; 0) {</div>
<div class="line"><a id="l00526" name="l00526"></a><span class="lineno">  526</span>                <span class="comment">/* This means that precipitation exceeded the capacity of the first layer */</span></div>
<div class="line"><a id="l00527" name="l00527"></a><span class="lineno">  527</span>                <span class="comment">/* Save this amount of water for the next layer */</span></div>
<div class="line"><a id="l00528" name="l00528"></a><span class="lineno">  528</span>                oldWaterIn = -diffw;</div>
<div class="line"><a id="l00529" name="l00529"></a><span class="lineno">  529</span>                aw = soil_field_capacity * layerDepth;</div>
<div class="line"><a id="l00530" name="l00530"></a><span class="lineno">  530</span>            } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00531" name="l00531"></a><span class="lineno">  531</span>                oldWaterIn = 0.0;</div>
<div class="line"><a id="l00532" name="l00532"></a><span class="lineno">  532</span>            }</div>
<div class="line"><a id="l00533" name="l00533"></a><span class="lineno">  533</span>        }</div>
<div class="line"><a id="l00534" name="l00534"></a><span class="lineno">  534</span> </div>
<div class="line"><a id="l00535" name="l00535"></a><span class="lineno">  535</span>        <span class="comment">/* Root Biomass */</span></div>
<div class="line"><a id="l00536" name="l00536"></a><span class="lineno">  536</span>        <span class="keywordtype">double</span> rootATdepth = rootDB * root_distribution.<a class="code hl_variable" href="structrd__str.html#ab5c89562271d3c87e310c002806858ae">rootDist</a>[i];</div>
<div class="line"><a id="l00537" name="l00537"></a><span class="lineno">  537</span>        return_value.<a class="code hl_variable" href="structsoil_m_l__str.html#ab5c89562271d3c87e310c002806858ae">rootDist</a>[i] = rootATdepth;</div>
<div class="line"><a id="l00538" name="l00538"></a><span class="lineno">  538</span>        <span class="comment">/* Plant available water is only between current water status and permanent wilting point */</span></div>
<div class="line"><a id="l00539" name="l00539"></a><span class="lineno">  539</span>        <span class="comment">/* Plant available water */</span></div>
<div class="line"><a id="l00540" name="l00540"></a><span class="lineno">  540</span>        <span class="keywordtype">double</span> pawha = (aw - soil_wilting_point * layerDepth) * 1e4;</div>
<div class="line"><a id="l00541" name="l00541"></a><span class="lineno">  541</span> </div>
<div class="line"><a id="l00542" name="l00542"></a><span class="lineno">  542</span>        <span class="keywordflow">if</span> (pawha &lt; 0) pawha = 0;</div>
<div class="line"><a id="l00543" name="l00543"></a><span class="lineno">  543</span> </div>
<div class="line"><a id="l00544" name="l00544"></a><span class="lineno">  544</span>        <span class="keywordtype">double</span> Ctransp = 0.0;</div>
<div class="line"><a id="l00545" name="l00545"></a><span class="lineno">  545</span>        <span class="keywordtype">double</span> EvapoTra = 0.0;</div>
<div class="line"><a id="l00546" name="l00546"></a><span class="lineno">  546</span>        <span class="keywordtype">double</span> Newpawha;</div>
<div class="line"><a id="l00547" name="l00547"></a><span class="lineno">  547</span> </div>
<div class="line"><a id="l00548" name="l00548"></a><span class="lineno">  548</span>        <span class="keywordflow">if</span> (i == 0) {</div>
<div class="line"><a id="l00549" name="l00549"></a><span class="lineno">  549</span>            <span class="comment">/* Only the first layer is affected by soil evaporation */</span></div>
<div class="line"><a id="l00550" name="l00550"></a><span class="lineno">  550</span>            <span class="keywordtype">double</span> awc2 = aw / layerDepth;</div>
<div class="line"><a id="l00551" name="l00551"></a><span class="lineno">  551</span>            <span class="comment">/* SoilEvapo function needs soil water content  */</span></div>
<div class="line"><a id="l00552" name="l00552"></a><span class="lineno">  552</span>            Sevap = <a class="code hl_function" href="_aux_bio_cro_8cpp.html#ab163aedfdfb73c66e5eb8dca307016be">SoilEvapo</a>(</div>
<div class="line"><a id="l00553" name="l00553"></a><span class="lineno">  553</span>                        LAI, k, AirTemp, IRad, awc2, soil_field_capacity,</div>
<div class="line"><a id="l00554" name="l00554"></a><span class="lineno">  554</span>                        soil_wilting_point, winds, RelH, rsec, soil_clod_size,</div>
<div class="line"><a id="l00555" name="l00555"></a><span class="lineno">  555</span>                        soil_reflectance, soil_transmission, specific_heat_of_air,</div>
<div class="line"><a id="l00556" name="l00556"></a><span class="lineno">  556</span>                        par_energy_content) *</div>
<div class="line"><a id="l00557" name="l00557"></a><span class="lineno">  557</span>                    3600 * 1e-3 * 10000;  <span class="comment">// Mg / ha / hr. 3600 s / hr * 1e-3 Mg / kg * 10000 m^2 / ha.</span></div>
<div class="line"><a id="l00558" name="l00558"></a><span class="lineno">  558</span>            <span class="comment">/* I assume that crop transpiration is distributed simlarly to</span></div>
<div class="line"><a id="l00559" name="l00559"></a><span class="lineno">  559</span><span class="comment">               root density.  In other words the crop takes up water proportionally</span></div>
<div class="line"><a id="l00560" name="l00560"></a><span class="lineno">  560</span><span class="comment">               to the amount of root in each respective layer.*/</span></div>
<div class="line"><a id="l00561" name="l00561"></a><span class="lineno">  561</span>            Ctransp = transp * root_distribution.<a class="code hl_variable" href="structrd__str.html#ab5c89562271d3c87e310c002806858ae">rootDist</a>[0];</div>
<div class="line"><a id="l00562" name="l00562"></a><span class="lineno">  562</span>            EvapoTra = Ctransp + Sevap;</div>
<div class="line"><a id="l00563" name="l00563"></a><span class="lineno">  563</span>            <span class="keyword">constexpr</span> <span class="keywordtype">double</span> density_of_water_at_20_celcius = 0.9982;  <span class="comment">// Mg m^-3.</span></div>
<div class="line"><a id="l00564" name="l00564"></a><span class="lineno">  564</span>            Newpawha = pawha - EvapoTra / density_of_water_at_20_celcius;</div>
<div class="line"><a id="l00565" name="l00565"></a><span class="lineno">  565</span>            <span class="comment">/* The first term in the rhs pawha is the m3 of water available in this layer.</span></div>
<div class="line"><a id="l00566" name="l00566"></a><span class="lineno">  566</span><span class="comment">               EvapoTra is the Mg H2O ha-1 of transpired and evaporated water. 1/0.9882 converts from Mg to m3 */</span></div>
<div class="line"><a id="l00567" name="l00567"></a><span class="lineno">  567</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00568" name="l00568"></a><span class="lineno">  568</span>            Ctransp = transp * root_distribution.<a class="code hl_variable" href="structrd__str.html#ab5c89562271d3c87e310c002806858ae">rootDist</a>[i];</div>
<div class="line"><a id="l00569" name="l00569"></a><span class="lineno">  569</span>            EvapoTra = Ctransp;</div>
<div class="line"><a id="l00570" name="l00570"></a><span class="lineno">  570</span>            Newpawha = pawha - (EvapoTra + oldEvapoTra);</div>
<div class="line"><a id="l00571" name="l00571"></a><span class="lineno">  571</span>        }</div>
<div class="line"><a id="l00572" name="l00572"></a><span class="lineno">  572</span> </div>
<div class="line"><a id="l00573" name="l00573"></a><span class="lineno">  573</span>        <span class="keywordflow">if</span> (Newpawha &lt; 0) {</div>
<div class="line"><a id="l00574" name="l00574"></a><span class="lineno">  574</span>            <span class="comment">/* If the Demand is not satisfied by this layer. This will be stored and added to subsequent layers*/</span></div>
<div class="line"><a id="l00575" name="l00575"></a><span class="lineno">  575</span>            oldEvapoTra = -Newpawha;</div>
<div class="line"><a id="l00576" name="l00576"></a><span class="lineno">  576</span>            aw = soil_wilting_point * layerDepth;</div>
<div class="line"><a id="l00577" name="l00577"></a><span class="lineno">  577</span>        }</div>
<div class="line"><a id="l00578" name="l00578"></a><span class="lineno">  578</span> </div>
<div class="line"><a id="l00579" name="l00579"></a><span class="lineno">  579</span>        <span class="keywordtype">double</span> awc = Newpawha / 1e4 / layerDepth + soil_wilting_point;</div>
<div class="line"><a id="l00580" name="l00580"></a><span class="lineno">  580</span> </div>
<div class="line"><a id="l00581" name="l00581"></a><span class="lineno">  581</span>        <span class="comment">/* This might look like a weird place to populate the structure, but is more convenient*/</span></div>
<div class="line"><a id="l00582" name="l00582"></a><span class="lineno">  582</span>        return_value.<a class="code hl_variable" href="structsoil_m_l__str.html#a9da7a4e25e646b0be31ac3bbec73f60d">cws</a>[i] = awc;</div>
<div class="line"><a id="l00583" name="l00583"></a><span class="lineno">  583</span> </div>
<div class="line"><a id="l00584" name="l00584"></a><span class="lineno">  584</span>        <span class="comment">// To-do: Replace this block with a call to compute_wsPhoto.</span></div>
<div class="line"><a id="l00585" name="l00585"></a><span class="lineno">  585</span>        <span class="comment">/* three different type of equations for modeling the effect of water stress on vmax and leaf area expansion.</span></div>
<div class="line"><a id="l00586" name="l00586"></a><span class="lineno">  586</span><span class="comment">       The equation for leaf area expansion is more severe than the one for vmax. */</span></div>
<div class="line"><a id="l00587" name="l00587"></a><span class="lineno">  587</span>        <span class="keywordtype">double</span> wsPhoto = 0.0;</div>
<div class="line"><a id="l00588" name="l00588"></a><span class="lineno">  588</span>        <span class="keywordtype">double</span> slp = 0.0;</div>
<div class="line"><a id="l00589" name="l00589"></a><span class="lineno">  589</span>        <span class="keywordtype">double</span> intcpt = 0.0;</div>
<div class="line"><a id="l00590" name="l00590"></a><span class="lineno">  590</span>        <span class="keywordtype">double</span> theta = 0.0;</div>
<div class="line"><a id="l00591" name="l00591"></a><span class="lineno">  591</span> </div>
<div class="line"><a id="l00592" name="l00592"></a><span class="lineno">  592</span>        <span class="keywordflow">if</span> (wsFun == 0) { <span class="comment">/* linear */</span></div>
<div class="line"><a id="l00593" name="l00593"></a><span class="lineno">  593</span>            slp = 1 / (soil_field_capacity - soil_wilting_point);</div>
<div class="line"><a id="l00594" name="l00594"></a><span class="lineno">  594</span>            intcpt = 1 - soil_field_capacity * slp;</div>
<div class="line"><a id="l00595" name="l00595"></a><span class="lineno">  595</span>            wsPhoto = slp * awc + intcpt;</div>
<div class="line"><a id="l00596" name="l00596"></a><span class="lineno">  596</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (wsFun == 1) {</div>
<div class="line"><a id="l00597" name="l00597"></a><span class="lineno">  597</span>            <span class="keywordtype">double</span> phi10 = (soil_field_capacity + soil_wilting_point) / 2;</div>
<div class="line"><a id="l00598" name="l00598"></a><span class="lineno">  598</span>            wsPhoto = 1 / (1 + exp((phi10 - awc) / phi1));</div>
<div class="line"><a id="l00599" name="l00599"></a><span class="lineno">  599</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (wsFun == 2) {</div>
<div class="line"><a id="l00600" name="l00600"></a><span class="lineno">  600</span>            slp = (1 - soil_wilting_point) / (soil_field_capacity - soil_wilting_point);</div>
<div class="line"><a id="l00601" name="l00601"></a><span class="lineno">  601</span>            intcpt = 1 - soil_field_capacity * slp;</div>
<div class="line"><a id="l00602" name="l00602"></a><span class="lineno">  602</span>            theta = slp * awc + intcpt;</div>
<div class="line"><a id="l00603" name="l00603"></a><span class="lineno">  603</span>            wsPhoto = (1 - exp(-2.5 * (theta - soil_wilting_point) / (1 - soil_wilting_point))) / (1 - exp(-2.5));</div>
<div class="line"><a id="l00604" name="l00604"></a><span class="lineno">  604</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (wsFun == 3) {</div>
<div class="line"><a id="l00605" name="l00605"></a><span class="lineno">  605</span>            wsPhoto = 1;</div>
<div class="line"><a id="l00606" name="l00606"></a><span class="lineno">  606</span>        }</div>
<div class="line"><a id="l00607" name="l00607"></a><span class="lineno">  607</span> </div>
<div class="line"><a id="l00608" name="l00608"></a><span class="lineno">  608</span>        <span class="keywordflow">if</span> (wsPhoto &lt;= 0)</div>
<div class="line"><a id="l00609" name="l00609"></a><span class="lineno">  609</span>            wsPhoto = 1e-10; <span class="comment">/* This can be mathematically lower than zero in some cases but I should prevent that. */</span></div>
<div class="line"><a id="l00610" name="l00610"></a><span class="lineno">  610</span> </div>
<div class="line"><a id="l00611" name="l00611"></a><span class="lineno">  611</span>        wsPhotoCol += wsPhoto;</div>
<div class="line"><a id="l00612" name="l00612"></a><span class="lineno">  612</span> </div>
<div class="line"><a id="l00613" name="l00613"></a><span class="lineno">  613</span>        <span class="keywordtype">double</span> LeafWS = pow(awc, phi2) * 1 / pow(soil_field_capacity, phi2);</div>
<div class="line"><a id="l00614" name="l00614"></a><span class="lineno">  614</span>        <span class="keywordflow">if</span> (wsFun == 3) {</div>
<div class="line"><a id="l00615" name="l00615"></a><span class="lineno">  615</span>            LeafWS = 1;</div>
<div class="line"><a id="l00616" name="l00616"></a><span class="lineno">  616</span>        }</div>
<div class="line"><a id="l00617" name="l00617"></a><span class="lineno">  617</span>        LeafWSCol += LeafWS;</div>
<div class="line"><a id="l00618" name="l00618"></a><span class="lineno">  618</span>    }</div>
<div class="line"><a id="l00619" name="l00619"></a><span class="lineno">  619</span> </div>
<div class="line"><a id="l00620" name="l00620"></a><span class="lineno">  620</span>    <span class="keywordflow">if</span> (waterIn &gt; 0) {</div>
<div class="line"><a id="l00621" name="l00621"></a><span class="lineno">  621</span>        drainage = waterIn;</div>
<div class="line"><a id="l00622" name="l00622"></a><span class="lineno">  622</span>        <span class="comment">/* Need to convert to units used in the Parton et al 1988 paper. */</span></div>
<div class="line"><a id="l00623" name="l00623"></a><span class="lineno">  623</span>        <span class="comment">/* The data comes in mm/hr and it needs to be in cm/month */</span></div>
<div class="line"><a id="l00624" name="l00624"></a><span class="lineno">  624</span>        return_value.<a class="code hl_variable" href="structsoil_m_l__str.html#a26953bee326ec08f079e24838fc8feb6">Nleach</a> = drainage * 0.1 * (1 / 24 * 30) / (1e3 * <a class="code hl_variable" href="namespacephysical__constants.html#a7162c8c2c8cfdb894219fadabc0a764c">physical_constants::molar_mass_of_water</a> * (0.2 + 0.7 * soil_sand_content));</div>
<div class="line"><a id="l00625" name="l00625"></a><span class="lineno">  625</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00626" name="l00626"></a><span class="lineno">  626</span>        return_value.<a class="code hl_variable" href="structsoil_m_l__str.html#a26953bee326ec08f079e24838fc8feb6">Nleach</a> = 0.0;</div>
<div class="line"><a id="l00627" name="l00627"></a><span class="lineno">  627</span>    }</div>
<div class="line"><a id="l00628" name="l00628"></a><span class="lineno">  628</span> </div>
<div class="line"><a id="l00629" name="l00629"></a><span class="lineno">  629</span>    return_value.<a class="code hl_variable" href="structsoil_m_l__str.html#a50be45bf1a7676b85f348d2a38d900b7">rcoefPhoto</a> = (wsPhotoCol / layers);</div>
<div class="line"><a id="l00630" name="l00630"></a><span class="lineno">  630</span>    return_value.<a class="code hl_variable" href="structsoil_m_l__str.html#a6b156f63a9c5f2185dcb004e85518998">drainage</a> = drainage;</div>
<div class="line"><a id="l00631" name="l00631"></a><span class="lineno">  631</span>    return_value.<a class="code hl_variable" href="structsoil_m_l__str.html#aff37ff3493aa80130290d80445e09c03">rcoefSpleaf</a> = (LeafWSCol / layers);</div>
<div class="line"><a id="l00632" name="l00632"></a><span class="lineno">  632</span>    return_value.<a class="code hl_variable" href="structsoil_m_l__str.html#a1181d419ee6ec88951ccc5d991626005">SoilEvapo</a> = Sevap;</div>
<div class="line"><a id="l00633" name="l00633"></a><span class="lineno">  633</span> </div>
<div class="line"><a id="l00634" name="l00634"></a><span class="lineno">  634</span>    <span class="keywordflow">return</span> return_value;</div>
<div class="line"><a id="l00635" name="l00635"></a><span class="lineno">  635</span>}</div>
<div class="line"><a id="l00636" name="l00636"></a><span class="lineno">  636</span> </div>
<div class="line"><a id="l00741" name="l00741"></a><span class="lineno"><a class="line" href="_aux_bio_cro_8cpp.html#aefe14addff3b3c1842f5558a8b26c24a">  741</a></span><span class="keywordtype">double</span> <a class="code hl_function" href="_aux_bio_cro_8cpp.html#aefe14addff3b3c1842f5558a8b26c24a">resp</a>(<span class="keywordtype">double</span> base_rate, <span class="keywordtype">double</span> grc, <span class="keywordtype">double</span> temp)</div>
<div class="line"><a id="l00742" name="l00742"></a><span class="lineno">  742</span>{</div>
<div class="line"><a id="l00743" name="l00743"></a><span class="lineno">  743</span>    <span class="keywordtype">double</span> ans = base_rate * (1 - (grc * <a class="code hl_function" href="temperature__response__functions_8h.html#a2f3f958811a5cf0d1dcb62c611bfcd41">Q10_temperature_response</a>(temp, 0.0)));</div>
<div class="line"><a id="l00744" name="l00744"></a><span class="lineno">  744</span> </div>
<div class="line"><a id="l00745" name="l00745"></a><span class="lineno">  745</span>    <span class="keywordflow">if</span> (ans &lt; 0) ans = 0;</div>
<div class="line"><a id="l00746" name="l00746"></a><span class="lineno">  746</span> </div>
<div class="line"><a id="l00747" name="l00747"></a><span class="lineno">  747</span>    <span class="keywordflow">return</span> ans;</div>
<div class="line"><a id="l00748" name="l00748"></a><span class="lineno">  748</span>}</div>
<div class="line"><a id="l00749" name="l00749"></a><span class="lineno">  749</span> </div>
<div class="line"><a id="l00750" name="l00750"></a><span class="lineno"><a class="line" href="_aux_bio_cro_8cpp.html#a50e5b19a1057a9edb5782670fb014d28">  750</a></span><a class="code hl_struct" href="structseq_r_d__str.html">seqRD_str</a> <a class="code hl_function" href="_aux_bio_cro_8cpp.html#a50e5b19a1057a9edb5782670fb014d28">seqRootDepth</a>(<span class="keywordtype">double</span> to, <span class="keywordtype">int</span> lengthOut)</div>
<div class="line"><a id="l00751" name="l00751"></a><span class="lineno">  751</span>{</div>
<div class="line"><a id="l00752" name="l00752"></a><span class="lineno">  752</span>    <span class="keywordtype">double</span> by = to / lengthOut;</div>
<div class="line"><a id="l00753" name="l00753"></a><span class="lineno">  753</span> </div>
<div class="line"><a id="l00754" name="l00754"></a><span class="lineno">  754</span>    <a class="code hl_struct" href="structseq_r_d__str.html">seqRD_str</a> result;</div>
<div class="line"><a id="l00755" name="l00755"></a><span class="lineno">  755</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt;= lengthOut; ++i) {</div>
<div class="line"><a id="l00756" name="l00756"></a><span class="lineno">  756</span>        result.<a class="code hl_variable" href="structseq_r_d__str.html#a510f69db6ac897b84a1d62973c365234">rootDepths</a>[i] = i * by;</div>
<div class="line"><a id="l00757" name="l00757"></a><span class="lineno">  757</span>    }</div>
<div class="line"><a id="l00758" name="l00758"></a><span class="lineno">  758</span>    <span class="keywordflow">return</span> result;</div>
<div class="line"><a id="l00759" name="l00759"></a><span class="lineno">  759</span>}</div>
<div class="line"><a id="l00760" name="l00760"></a><span class="lineno">  760</span> </div>
<div class="line"><a id="l00761" name="l00761"></a><span class="lineno"><a class="line" href="_aux_bio_cro_8cpp.html#afc92a0998ee191ec72b256ad232804c9">  761</a></span><a class="code hl_struct" href="structrd__str.html">rd_str</a> <a class="code hl_function" href="_aux_bio_cro_8cpp.html#afc92a0998ee191ec72b256ad232804c9">rootDist</a>(<span class="keywordtype">int</span> n_layers, <span class="keywordtype">double</span> rootDepth, <span class="keywordtype">double</span>* depths, <span class="keywordtype">double</span> rfl)</div>
<div class="line"><a id="l00762" name="l00762"></a><span class="lineno">  762</span>{</div>
<div class="line"><a id="l00763" name="l00763"></a><span class="lineno">  763</span>    <span class="comment">/*</span></div>
<div class="line"><a id="l00764" name="l00764"></a><span class="lineno">  764</span><span class="comment">     * Calculate the fraction of total root mass for each layer in `depths` assuming the mass</span></div>
<div class="line"><a id="l00765" name="l00765"></a><span class="lineno">  765</span><span class="comment">     * is follows a Poisson distribution along the depth.</span></div>
<div class="line"><a id="l00766" name="l00766"></a><span class="lineno">  766</span><span class="comment">     *</span></div>
<div class="line"><a id="l00767" name="l00767"></a><span class="lineno">  767</span><span class="comment">     * Returns a struct with one array of size `n_layers`.</span></div>
<div class="line"><a id="l00768" name="l00768"></a><span class="lineno">  768</span><span class="comment">     * Each element in the array is the fraction of total root mass in that layer.</span></div>
<div class="line"><a id="l00769" name="l00769"></a><span class="lineno">  769</span><span class="comment">     * The sum of all elements of the result equals 1.</span></div>
<div class="line"><a id="l00770" name="l00770"></a><span class="lineno">  770</span><span class="comment">     */</span></div>
<div class="line"><a id="l00771" name="l00771"></a><span class="lineno">  771</span> </div>
<div class="line"><a id="l00772" name="l00772"></a><span class="lineno">  772</span>    <span class="keywordtype">double</span> layerDepth = 0.0;</div>
<div class="line"><a id="l00773" name="l00773"></a><span class="lineno">  773</span>    <span class="keywordtype">double</span> CumLayerDepth = 0.0;</div>
<div class="line"><a id="l00774" name="l00774"></a><span class="lineno">  774</span>    <span class="keywordtype">int</span> CumRootDist = 1;</div>
<div class="line"><a id="l00775" name="l00775"></a><span class="lineno">  775</span>    vector&lt;double&gt; <a class="code hl_function" href="_aux_bio_cro_8cpp.html#afc92a0998ee191ec72b256ad232804c9">rootDist</a>(n_layers);</div>
<div class="line"><a id="l00776" name="l00776"></a><span class="lineno">  776</span>    <span class="keywordtype">double</span> cumulative_a = 0.0;</div>
<div class="line"><a id="l00777" name="l00777"></a><span class="lineno">  777</span> </div>
<div class="line"><a id="l00778" name="l00778"></a><span class="lineno">  778</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; n_layers; ++i) {</div>
<div class="line"><a id="l00779" name="l00779"></a><span class="lineno">  779</span>        <span class="keywordflow">if</span> (i == 0) {</div>
<div class="line"><a id="l00780" name="l00780"></a><span class="lineno">  780</span>            layerDepth = depths[1];</div>
<div class="line"><a id="l00781" name="l00781"></a><span class="lineno">  781</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00782" name="l00782"></a><span class="lineno">  782</span>            layerDepth = depths[i] - depths[i - 1];</div>
<div class="line"><a id="l00783" name="l00783"></a><span class="lineno">  783</span>        }</div>
<div class="line"><a id="l00784" name="l00784"></a><span class="lineno">  784</span> </div>
<div class="line"><a id="l00785" name="l00785"></a><span class="lineno">  785</span>        CumLayerDepth += layerDepth;</div>
<div class="line"><a id="l00786" name="l00786"></a><span class="lineno">  786</span> </div>
<div class="line"><a id="l00787" name="l00787"></a><span class="lineno">  787</span>        <span class="keywordflow">if</span> (rootDepth &gt; CumLayerDepth) {</div>
<div class="line"><a id="l00788" name="l00788"></a><span class="lineno">  788</span>            CumRootDist++;</div>
<div class="line"><a id="l00789" name="l00789"></a><span class="lineno">  789</span>        }</div>
<div class="line"><a id="l00790" name="l00790"></a><span class="lineno">  790</span>    }</div>
<div class="line"><a id="l00791" name="l00791"></a><span class="lineno">  791</span> </div>
<div class="line"><a id="l00792" name="l00792"></a><span class="lineno">  792</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; n_layers; ++j) {</div>
<div class="line"><a id="l00793" name="l00793"></a><span class="lineno">  793</span>        <span class="keywordflow">if</span> (j &lt; CumRootDist) {</div>
<div class="line"><a id="l00794" name="l00794"></a><span class="lineno">  794</span>            <span class="keywordtype">double</span> a = <a class="code hl_function" href="_aux_bio_cro_8cpp.html#add002b19ebc8390b467dd10c31bb2cb5">poisson_density</a>(j + 1, CumRootDist * rfl);</div>
<div class="line"><a id="l00795" name="l00795"></a><span class="lineno">  795</span>            <a class="code hl_function" href="_aux_bio_cro_8cpp.html#afc92a0998ee191ec72b256ad232804c9">rootDist</a>[j] = a;</div>
<div class="line"><a id="l00796" name="l00796"></a><span class="lineno">  796</span>            cumulative_a += a;</div>
<div class="line"><a id="l00797" name="l00797"></a><span class="lineno">  797</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00798" name="l00798"></a><span class="lineno">  798</span>            <a class="code hl_function" href="_aux_bio_cro_8cpp.html#afc92a0998ee191ec72b256ad232804c9">rootDist</a>[j] = 0;</div>
<div class="line"><a id="l00799" name="l00799"></a><span class="lineno">  799</span>        }</div>
<div class="line"><a id="l00800" name="l00800"></a><span class="lineno">  800</span>    }</div>
<div class="line"><a id="l00801" name="l00801"></a><span class="lineno">  801</span> </div>
<div class="line"><a id="l00802" name="l00802"></a><span class="lineno">  802</span>    <a class="code hl_struct" href="structrd__str.html">rd_str</a> result;</div>
<div class="line"><a id="l00803" name="l00803"></a><span class="lineno">  803</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; n_layers; ++k) {</div>
<div class="line"><a id="l00804" name="l00804"></a><span class="lineno">  804</span>        result.<a class="code hl_variable" href="structrd__str.html#ab5c89562271d3c87e310c002806858ae">rootDist</a>[k] = <a class="code hl_function" href="_aux_bio_cro_8cpp.html#afc92a0998ee191ec72b256ad232804c9">rootDist</a>[k] / cumulative_a;</div>
<div class="line"><a id="l00805" name="l00805"></a><span class="lineno">  805</span>    }</div>
<div class="line"><a id="l00806" name="l00806"></a><span class="lineno">  806</span>    <span class="keywordflow">return</span> result;</div>
<div class="line"><a id="l00807" name="l00807"></a><span class="lineno">  807</span>}</div>
<div class="ttc" id="a_aux_bio_cro_8cpp_html_a058be0e6ed718b377d7c6056cceb09a8"><div class="ttname"><a href="_aux_bio_cro_8cpp.html#a058be0e6ed718b377d7c6056cceb09a8">compute_wsPhoto</a></div><div class="ttdeci">double compute_wsPhoto(int wsFun, double fieldc, double wiltp, double phi1, double awc)</div><div class="ttdef"><b>Definition:</b> <a href="_aux_bio_cro_8cpp_source.html#l00299">AuxBioCro.cpp:299</a></div></div>
<div class="ttc" id="a_aux_bio_cro_8cpp_html_a50e5b19a1057a9edb5782670fb014d28"><div class="ttname"><a href="_aux_bio_cro_8cpp.html#a50e5b19a1057a9edb5782670fb014d28">seqRootDepth</a></div><div class="ttdeci">seqRD_str seqRootDepth(double to, int lengthOut)</div><div class="ttdef"><b>Definition:</b> <a href="_aux_bio_cro_8cpp_source.html#l00750">AuxBioCro.cpp:750</a></div></div>
<div class="ttc" id="a_aux_bio_cro_8cpp_html_a5f7c5a71f330ff99444aebac9e0538b3"><div class="ttname"><a href="_aux_bio_cro_8cpp.html#a5f7c5a71f330ff99444aebac9e0538b3">LNprof</a></div><div class="ttdeci">void LNprof(double LeafN, double LAI, double kpLN, vector&lt; double &gt; &amp;leafN_profile)</div><div class="ttdef"><b>Definition:</b> <a href="_aux_bio_cro_8cpp_source.html#l00185">AuxBioCro.cpp:185</a></div></div>
<div class="ttc" id="a_aux_bio_cro_8cpp_html_a7f7b8457e2206d31608f20cc696341b7"><div class="ttname"><a href="_aux_bio_cro_8cpp.html#a7f7b8457e2206d31608f20cc696341b7">soilML</a></div><div class="ttdeci">soilML_str soilML(double precipit, double transp, double *cws, double soildepth, double *depths, double soil_field_capacity, double soil_wilting_point, double soil_saturation_capacity, double soil_air_entry, double soil_saturated_conductivity, double soil_b_coefficient, double soil_sand_content, double phi1, double phi2, int wsFun, int layers, double rootDB, double LAI, double k, double AirTemp, double IRad, double winds, double RelH, int hydrDist, double rfl, double rsec, double rsdf, double soil_clod_size, double soil_reflectance, double soil_transmission, double specific_heat_of_air, double par_energy_content)</div><div class="ttdef"><b>Definition:</b> <a href="_aux_bio_cro_8cpp_source.html#l00420">AuxBioCro.cpp:420</a></div></div>
<div class="ttc" id="a_aux_bio_cro_8cpp_html_aa4d2cdd07093428af4830f4c8afd660c"><div class="ttname"><a href="_aux_bio_cro_8cpp.html#aa4d2cdd07093428af4830f4c8afd660c">RHprof</a></div><div class="ttdeci">void RHprof(double RH, int nlayers, double *relative_humidity_profile)</div><div class="ttdoc">Calculates a relative humidity profile throughout a multilayer canopy.</div><div class="ttdef"><b>Definition:</b> <a href="_aux_bio_cro_8cpp_source.html#l00167">AuxBioCro.cpp:167</a></div></div>
<div class="ttc" id="a_aux_bio_cro_8cpp_html_ab163aedfdfb73c66e5eb8dca307016be"><div class="ttname"><a href="_aux_bio_cro_8cpp.html#ab163aedfdfb73c66e5eb8dca307016be">SoilEvapo</a></div><div class="ttdeci">double SoilEvapo(double LAI, double k, double air_temperature, double ppfd, double soil_water_content, double fieldc, double wiltp, double winds, double RelH, double rsec, double soil_clod_size, double soil_reflectance, double soil_transmission, double specific_heat_of_air, double par_energy_content)</div><div class="ttdef"><b>Definition:</b> <a href="_aux_bio_cro_8cpp_source.html#l00203">AuxBioCro.cpp:203</a></div></div>
<div class="ttc" id="a_aux_bio_cro_8cpp_html_ac06a9906f486254d46a6838a86a52dcd"><div class="ttname"><a href="_aux_bio_cro_8cpp.html#ac06a9906f486254d46a6838a86a52dcd">WINDprof</a></div><div class="ttdeci">void WINDprof(double WindSpeed, double LAI, vector&lt; double &gt; &amp;wind_speed_profile)</div><div class="ttdoc">Wind profile function.</div><div class="ttdef"><b>Definition:</b> <a href="_aux_bio_cro_8cpp_source.html#l00067">AuxBioCro.cpp:67</a></div></div>
<div class="ttc" id="a_aux_bio_cro_8cpp_html_add002b19ebc8390b467dd10c31bb2cb5"><div class="ttname"><a href="_aux_bio_cro_8cpp.html#add002b19ebc8390b467dd10c31bb2cb5">poisson_density</a></div><div class="ttdeci">double poisson_density(int x, double lambda)</div><div class="ttdef"><b>Definition:</b> <a href="_aux_bio_cro_8cpp_source.html#l00039">AuxBioCro.cpp:39</a></div></div>
<div class="ttc" id="a_aux_bio_cro_8cpp_html_aefe14addff3b3c1842f5558a8b26c24a"><div class="ttname"><a href="_aux_bio_cro_8cpp.html#aefe14addff3b3c1842f5558a8b26c24a">resp</a></div><div class="ttdeci">double resp(double base_rate, double grc, double temp)</div><div class="ttdoc">Subtracts respiratory losses from a carbon production rate.</div><div class="ttdef"><b>Definition:</b> <a href="_aux_bio_cro_8cpp_source.html#l00741">AuxBioCro.cpp:741</a></div></div>
<div class="ttc" id="a_aux_bio_cro_8cpp_html_afc92a0998ee191ec72b256ad232804c9"><div class="ttname"><a href="_aux_bio_cro_8cpp.html#afc92a0998ee191ec72b256ad232804c9">rootDist</a></div><div class="ttdeci">rd_str rootDist(int n_layers, double rootDepth, double *depths, double rfl)</div><div class="ttdef"><b>Definition:</b> <a href="_aux_bio_cro_8cpp_source.html#l00761">AuxBioCro.cpp:761</a></div></div>
<div class="ttc" id="a_aux_bio_cro_8cpp_html_afd82d6a23b65b58f4b7652dc9c8146c3"><div class="ttname"><a href="_aux_bio_cro_8cpp.html#afd82d6a23b65b58f4b7652dc9c8146c3">watstr</a></div><div class="ttdeci">ws_str watstr(double precipit, double evapo, double cws, double soildepth, double fieldc, double wiltp, double soil_saturation_capacity, double sand, double Ks, double air_entry, double b)</div><div class="ttdef"><b>Definition:</b> <a href="_aux_bio_cro_8cpp_source.html#l00353">AuxBioCro.cpp:353</a></div></div>
<div class="ttc" id="a_aux_bio_cro_8h_html_a57179778cb6aed95fb9f484b55873d6f"><div class="ttname"><a href="_aux_bio_cro_8h.html#a57179778cb6aed95fb9f484b55873d6f">MAXLAY</a></div><div class="ttdeci">#define MAXLAY</div><div class="ttdef"><b>Definition:</b> <a href="_aux_bio_cro_8h_source.html#l00013">AuxBioCro.h:13</a></div></div>
<div class="ttc" id="a_bio_cro_8h_html"><div class="ttname"><a href="_bio_cro_8h.html">BioCro.h</a></div></div>
<div class="ttc" id="aboundary__layer__conductance_8h_html"><div class="ttname"><a href="boundary__layer__conductance_8h.html">boundary_layer_conductance.h</a></div></div>
<div class="ttc" id="ac4photo_8h_html"><div class="ttname"><a href="c4photo_8h.html">c4photo.h</a></div></div>
<div class="ttc" id="anamespaceconversion__constants_html_ac29e2ff8a2fe79bf1a6e7f5623f8f8a3"><div class="ttname"><a href="namespaceconversion__constants.html#ac29e2ff8a2fe79bf1a6e7f5623f8f8a3">conversion_constants::celsius_to_kelvin</a></div><div class="ttdeci">constexpr double celsius_to_kelvin</div><div class="ttdef"><b>Definition:</b> <a href="constants_8h_source.html#l00032">constants.h:32</a></div></div>
<div class="ttc" id="anamespacephysical__constants_html_a7162c8c2c8cfdb894219fadabc0a764c"><div class="ttname"><a href="namespacephysical__constants.html#a7162c8c2c8cfdb894219fadabc0a764c">physical_constants::molar_mass_of_water</a></div><div class="ttdeci">constexpr double molar_mass_of_water</div><div class="ttdef"><b>Definition:</b> <a href="constants_8h_source.html#l00074">constants.h:74</a></div></div>
<div class="ttc" id="anamespacephysical__constants_html_ab993d2950483e6b20ca63c46f8134241"><div class="ttname"><a href="namespacephysical__constants.html#ab993d2950483e6b20ca63c46f8134241">physical_constants::stefan_boltzmann</a></div><div class="ttdeci">constexpr double stefan_boltzmann</div><div class="ttdef"><b>Definition:</b> <a href="constants_8h_source.html#l00071">constants.h:71</a></div></div>
<div class="ttc" id="astructrd__str_html"><div class="ttname"><a href="structrd__str.html">rd_str</a></div><div class="ttdef"><b>Definition:</b> <a href="_aux_bio_cro_8h_source.html#l00056">AuxBioCro.h:56</a></div></div>
<div class="ttc" id="astructrd__str_html_ab5c89562271d3c87e310c002806858ae"><div class="ttname"><a href="structrd__str.html#ab5c89562271d3c87e310c002806858ae">rd_str::rootDist</a></div><div class="ttdeci">double rootDist[MAXLAY]</div><div class="ttdef"><b>Definition:</b> <a href="_aux_bio_cro_8h_source.html#l00057">AuxBioCro.h:57</a></div></div>
<div class="ttc" id="astructseq_r_d__str_html"><div class="ttname"><a href="structseq_r_d__str.html">seqRD_str</a></div><div class="ttdef"><b>Definition:</b> <a href="_aux_bio_cro_8h_source.html#l00050">AuxBioCro.h:50</a></div></div>
<div class="ttc" id="astructseq_r_d__str_html_a510f69db6ac897b84a1d62973c365234"><div class="ttname"><a href="structseq_r_d__str.html#a510f69db6ac897b84a1d62973c365234">seqRD_str::rootDepths</a></div><div class="ttdeci">double rootDepths[MAXLAY+1]</div><div class="ttdef"><b>Definition:</b> <a href="_aux_bio_cro_8h_source.html#l00051">AuxBioCro.h:51</a></div></div>
<div class="ttc" id="astructsoil_m_l__str_html"><div class="ttname"><a href="structsoil_m_l__str.html">soilML_str</a></div><div class="ttdef"><b>Definition:</b> <a href="_aux_bio_cro_8h_source.html#l00030">AuxBioCro.h:30</a></div></div>
<div class="ttc" id="astructsoil_m_l__str_html_a1181d419ee6ec88951ccc5d991626005"><div class="ttname"><a href="structsoil_m_l__str.html#a1181d419ee6ec88951ccc5d991626005">soilML_str::SoilEvapo</a></div><div class="ttdeci">double SoilEvapo</div><div class="ttdef"><b>Definition:</b> <a href="_aux_bio_cro_8h_source.html#l00036">AuxBioCro.h:36</a></div></div>
<div class="ttc" id="astructsoil_m_l__str_html_a26953bee326ec08f079e24838fc8feb6"><div class="ttname"><a href="structsoil_m_l__str.html#a26953bee326ec08f079e24838fc8feb6">soilML_str::Nleach</a></div><div class="ttdeci">double Nleach</div><div class="ttdef"><b>Definition:</b> <a href="_aux_bio_cro_8h_source.html#l00035">AuxBioCro.h:35</a></div></div>
<div class="ttc" id="astructsoil_m_l__str_html_a50be45bf1a7676b85f348d2a38d900b7"><div class="ttname"><a href="structsoil_m_l__str.html#a50be45bf1a7676b85f348d2a38d900b7">soilML_str::rcoefPhoto</a></div><div class="ttdeci">double rcoefPhoto</div><div class="ttdef"><b>Definition:</b> <a href="_aux_bio_cro_8h_source.html#l00031">AuxBioCro.h:31</a></div></div>
<div class="ttc" id="astructsoil_m_l__str_html_a6b156f63a9c5f2185dcb004e85518998"><div class="ttname"><a href="structsoil_m_l__str.html#a6b156f63a9c5f2185dcb004e85518998">soilML_str::drainage</a></div><div class="ttdeci">double drainage</div><div class="ttdef"><b>Definition:</b> <a href="_aux_bio_cro_8h_source.html#l00034">AuxBioCro.h:34</a></div></div>
<div class="ttc" id="astructsoil_m_l__str_html_a9da7a4e25e646b0be31ac3bbec73f60d"><div class="ttname"><a href="structsoil_m_l__str.html#a9da7a4e25e646b0be31ac3bbec73f60d">soilML_str::cws</a></div><div class="ttdeci">double cws[MAXLAY]</div><div class="ttdef"><b>Definition:</b> <a href="_aux_bio_cro_8h_source.html#l00033">AuxBioCro.h:33</a></div></div>
<div class="ttc" id="astructsoil_m_l__str_html_ab5c89562271d3c87e310c002806858ae"><div class="ttname"><a href="structsoil_m_l__str.html#ab5c89562271d3c87e310c002806858ae">soilML_str::rootDist</a></div><div class="ttdeci">double rootDist[MAXLAY]</div><div class="ttdef"><b>Definition:</b> <a href="_aux_bio_cro_8h_source.html#l00037">AuxBioCro.h:37</a></div></div>
<div class="ttc" id="astructsoil_m_l__str_html_aff37ff3493aa80130290d80445e09c03"><div class="ttname"><a href="structsoil_m_l__str.html#aff37ff3493aa80130290d80445e09c03">soilML_str::rcoefSpleaf</a></div><div class="ttdeci">double rcoefSpleaf</div><div class="ttdef"><b>Definition:</b> <a href="_aux_bio_cro_8h_source.html#l00032">AuxBioCro.h:32</a></div></div>
<div class="ttc" id="astructws__str_html"><div class="ttname"><a href="structws__str.html">ws_str</a></div><div class="ttdef"><b>Definition:</b> <a href="_aux_bio_cro_8h_source.html#l00023">AuxBioCro.h:23</a></div></div>
<div class="ttc" id="astructws__str_html_a26953bee326ec08f079e24838fc8feb6"><div class="ttname"><a href="structws__str.html#a26953bee326ec08f079e24838fc8feb6">ws_str::Nleach</a></div><div class="ttdeci">double Nleach</div><div class="ttdef"><b>Definition:</b> <a href="_aux_bio_cro_8h_source.html#l00027">AuxBioCro.h:27</a></div></div>
<div class="ttc" id="astructws__str_html_a365dc60f2331a4280fc2be55b822191c"><div class="ttname"><a href="structws__str.html#a365dc60f2331a4280fc2be55b822191c">ws_str::runoff</a></div><div class="ttdeci">double runoff</div><div class="ttdef"><b>Definition:</b> <a href="_aux_bio_cro_8h_source.html#l00026">AuxBioCro.h:26</a></div></div>
<div class="ttc" id="astructws__str_html_aa293628634276d793267cbf2542ce2e2"><div class="ttname"><a href="structws__str.html#aa293628634276d793267cbf2542ce2e2">ws_str::awc</a></div><div class="ttdeci">double awc</div><div class="ttdef"><b>Definition:</b> <a href="_aux_bio_cro_8h_source.html#l00024">AuxBioCro.h:24</a></div></div>
<div class="ttc" id="astructws__str_html_ac2f458ad74016a5af57f18d9774bb0d9"><div class="ttname"><a href="structws__str.html#ac2f458ad74016a5af57f18d9774bb0d9">ws_str::psim</a></div><div class="ttdeci">double psim</div><div class="ttdef"><b>Definition:</b> <a href="_aux_bio_cro_8h_source.html#l00025">AuxBioCro.h:25</a></div></div>
<div class="ttc" id="asun_m_l_8cpp_html_ab491bb8553ee710f275dbcd2b3e4547b"><div class="ttname"><a href="sun_m_l_8cpp.html#ab491bb8553ee710f275dbcd2b3e4547b">thick_layer_absorption</a></div><div class="ttdeci">double thick_layer_absorption(double R, double T, double I_0)</div><div class="ttdoc">Computes absorbed light from incident light for a thick layer of material.</div><div class="ttdef"><b>Definition:</b> <a href="sun_m_l_8cpp_source.html#l00079">sunML.cpp:79</a></div></div>
<div class="ttc" id="asun_m_l_8h_html"><div class="ttname"><a href="sun_m_l_8h.html">sunML.h</a></div></div>
<div class="ttc" id="atemperature__response__functions_8h_html"><div class="ttname"><a href="temperature__response__functions_8h.html">temperature_response_functions.h</a></div></div>
<div class="ttc" id="atemperature__response__functions_8h_html_a2f3f958811a5cf0d1dcb62c611bfcd41"><div class="ttname"><a href="temperature__response__functions_8h.html#a2f3f958811a5cf0d1dcb62c611bfcd41">Q10_temperature_response</a></div><div class="ttdeci">double Q10_temperature_response(double temperature, double Tref)</div><div class="ttdoc">A typical Q10-based temperature response. The two temperatures below must be supplied in the same uni...</div><div class="ttdef"><b>Definition:</b> <a href="temperature__response__functions_8h_source.html#l00065">temperature_response_functions.h:65</a></div></div>
<div class="ttc" id="awater__and__air__properties_8h_html"><div class="ttname"><a href="water__and__air__properties_8h.html">water_and_air_properties.h</a></div></div>
<div class="ttc" id="awater__and__air__properties_8h_html_a05f381bbff6170709a8d0e2e34f4556a"><div class="ttname"><a href="water__and__air__properties_8h.html#a05f381bbff6170709a8d0e2e34f4556a">TempToSFS</a></div><div class="ttdeci">double TempToSFS(double air_temperature)</div><div class="ttdoc">Determine the derivative of saturation water vapor density with respect to temperature at a particula...</div><div class="ttdef"><b>Definition:</b> <a href="water__and__air__properties_8h_source.html#l00208">water_and_air_properties.h:208</a></div></div>
<div class="ttc" id="awater__and__air__properties_8h_html_a117fba2c85ba6d52345e7cefc05a43ff"><div class="ttname"><a href="water__and__air__properties_8h.html#a117fba2c85ba6d52345e7cefc05a43ff">saturation_vapor_pressure</a></div><div class="ttdeci">double saturation_vapor_pressure(double air_temperature)</div><div class="ttdoc">Determine saturation water vapor pressure (Pa) from air temperature (degrees C) using the Arden Buck ...</div><div class="ttdef"><b>Definition:</b> <a href="water__and__air__properties_8h_source.html#l00058">water_and_air_properties.h:58</a></div></div>
<div class="ttc" id="awater__and__air__properties_8h_html_a460579178484521ecc50b488c58bb0dd"><div class="ttname"><a href="water__and__air__properties_8h.html#a460579178484521ecc50b488c58bb0dd">TempToLHV</a></div><div class="ttdeci">double TempToLHV(double temperature)</div><div class="ttdoc">Determine the latent heat of vaporization for water from its temperature.</div><div class="ttdef"><b>Definition:</b> <a href="water__and__air__properties_8h_source.html#l00151">water_and_air_properties.h:151</a></div></div>
<div class="ttc" id="awater__and__air__properties_8h_html_a6380d8cd4192408df76baefe6b369a70"><div class="ttname"><a href="water__and__air__properties_8h.html#a6380d8cd4192408df76baefe6b369a70">TempToDdryA</a></div><div class="ttdeci">double TempToDdryA(double air_temperature)</div><div class="ttdoc">Determines the density of dry air from the air temperature.</div><div class="ttdef"><b>Definition:</b> <a href="water__and__air__properties_8h_source.html#l00092">water_and_air_properties.h:92</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Fri Mar 7 2025 22:22:20 for The BioCro C++ Library by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.4
</small></address>
</body>
</html>
