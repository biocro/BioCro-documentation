<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Energy Balance, Transpiration, and Leaf Temperature • BioCro</title>
<script src="../../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../../deps/headroom-0.11.0/headroom.min.js"></script><script src="../../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../../deps/search-1.0.0/fuse.min.js"></script><script src="../../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../../pkgdown.js"></script><meta property="og:title" content="Energy Balance, Transpiration, and Leaf Temperature">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../../index.html">BioCro</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">3.2.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../../about_pkgdown_documentation.html">About</a></li>
<li class="nav-item"><a class="nav-link" href="../../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><h6 class="dropdown-header" data-toc-skip>GENERAL BIOCRO USAGE</h6></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../../articles/BioCro.html">Getting Started with BioCro (HTML)</a></li>
    <li><a class="dropdown-item" href="../../articles/web_only/a_practical_guide_to_biocro.pdf">A Practical Guide to BioCro (PDF)</a></li>
    <li><a class="dropdown-item" href="../../articles/web_only/a_practical_guide_to_biocro.R">    [R code]</a></li>
    <li><a class="dropdown-item" href="../../articles/web_only/quantitative_model_comparison.pdf">Quantitative Comparison Between Two Photosynthesis Models (PDF)</a></li>
    <li><a class="dropdown-item" href="../../articles/web_only/quantitative_model_comparison.R">    [R code]</a></li>
    <li><a class="dropdown-item" href="../../articles/web_only/BioCro-II_Paper--Section-1.1-example.html">BioCro II Paper: Section 1.1 Example (HTML)</a></li>
    <li><a class="dropdown-item" href="../../articles/web_only/dynamical_systems.pdf">BioCro as a Dynamical System</a></li>
    <li><a class="dropdown-item" href="../../articles/web_only/an_introduction_to_biocro.pdf">An Introduction to BioCro for Those Who Want to Add Models (PDF)</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>CROP GROWTH MODELING TOPICS</h6></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../../articles/web_only/avoiding_pitfalls_fvcb.html">Avoiding Pitfalls When Using the FvCB Model (HTML)</a></li>
    <li><a class="dropdown-item" href="../../articles/web_only/thick_layer_absorption.html">Light Absorption by a Thick Layer (HTML)</a></li>
    <li><a class="dropdown-item" href="../../articles/web_only/ball_berry_model.html">Using the Ball-Berry Model (HTML)</a></li>
    <li><a class="dropdown-item" href="../../articles/web_only/canopy_photosynthesis.html">Multi-layer Canopy Photosynthesis Models (HTML)</a></li>
    <li><a class="dropdown-item" href="../../articles/web_only/energy_balance.html">Energy Balance, Leaf Temperature, and Transpiration (HTML)</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../../../bookdown/index.html">Developer's Manual</a></li>
<li class="nav-item"><a class="nav-link" href="../../news/index.html">Changelog</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-c-library" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">C++ Library</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-c-library">
<li><a class="dropdown-item" href="../../../doxygen/doxygen_docs_complete/index.html">Complete Doxygen Documentation</a></li>
    <li><a class="dropdown-item" href="../../../doxygen/doxygen_docs_framework/index.html">Framework Documentation</a></li>
    <li><a class="dropdown-item" href="../../../doxygen/doxygen_docs_modules/index.html">BioCro Module Documentation</a></li>
    <li><a class="dropdown-item" href="../../../doxygen/doxygen_docs_modules_public_members_only/index.html">BioCro Module Documentation (public members only)</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/biocro/biocro/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">


<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Energy Balance, Transpiration, and Leaf Temperature</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/biocro/biocro/blob/v3.2.0/vignettes/web_only/energy_balance.Rmd" class="external-link"><code>vignettes/web_only/energy_balance.Rmd</code></a></small>
      <div class="d-none name"><code>energy_balance.Rmd</code></div>
    </div>

    
    
<div class="section level2" number="1">
<h2 id="generalEB">
<span class="header-section-number">1</span> Canopy Energy Balance<a class="anchor" aria-label="anchor" href="#generalEB"></a>
</h2>
<p>Energy balance is discussed in many sources, such as <span class="citation">Thornley and Johnson (<a href="#ref-thornley_plant_1990">1990</a>)</span> and
<span class="citation">Campbell and Norman (<a href="#ref-campbell_introduction_1998">1998</a>)</span>, the two main references for BioCro models. Here we
begin with a general discussion, mostly using the notation from Chapter 14 of
<span class="citation">Thornley and Johnson (<a href="#ref-thornley_plant_1990">1990</a>)</span>, but also borrowing a bit from Chapters 12 and 14 of
<span class="citation">Campbell and Norman (<a href="#ref-campbell_introduction_1998">1998</a>)</span>.</p>
<p>First, the total light energy (shortwave and longwave) absorbed by the canopy
(<span class="math inline">\(J_a\)</span>) is all dissipated or stored by the following processes:</p>
<ul>
<li><p>Long-wave energy loss to the environment</p></li>
<li><p>Convective heat transfer between the canopy and the air</p></li>
<li><p>Evaporation of water from the interior surfaces of the leaves</p></li>
<li><p>Conductive heat transfer between the canopy and the ground</p></li>
<li><p>Canopy metabolism</p></li>
<li><p>Heat storage by the canopy</p></li>
</ul>
<p>Mathematically, we can express this idea as</p>
<p><span class="math display" id="eq:EB1">\[\begin{equation}
    J_a - R_L - H - \lambda E - G - M = q, \tag{1.1}
\end{equation}\]</span></p>
<p>where <span class="math inline">\(R_L\)</span> is the rate of long-wave energy loss, <span class="math inline">\(H\)</span> is the rate of conductive
heat transfer, <span class="math inline">\(\lambda\)</span> is the latent heat of vaporization of water, <span class="math inline">\(E\)</span> is the
transpiration rate, <span class="math inline">\(G\)</span> is the rate of heat loss to the ground, <span class="math inline">\(M\)</span> is the rate
of energy used by canopy metabolism, and <span class="math inline">\(q\)</span> is the rate of heat storage by the
canopy. Most of the quantities above are energy flux densities with typical
units of J m<span class="math inline">\(^{-2}\)</span> s<span class="math inline">\(^{-1}\)</span>. The only exception is <span class="math inline">\(\lambda\)</span>, which typically
has units of J kg<span class="math inline">\(^{-1}\)</span>. Equation <a href="#eq:EB1">(1.1)</a> is a crop-specific version of
the more general principle of
<a href="https://en.wikipedia.org/wiki/Conservation_of_energy" class="external-link">conservation of energy</a>,
and it already begins to highlight the connection between energy and
transpiration.</p>
<p>The term “energy balance” is synonymous with “steady-state energy flow.” Thus,
energy balance calculations are always made under the assumption that <span class="math inline">\(q = 0\)</span>.
Another simplification is that the metabolic processes of photosynthesis and
respiration only dissipate a small fraction of the incident energy, and can thus
be ignored. Finally, we can combine <span class="math inline">\(J_a\)</span>, <span class="math inline">\(R_L\)</span>, and <span class="math inline">\(G\)</span> into a single term
(<span class="math inline">\(\phi_N\)</span>):</p>
<p><span class="math display" id="eq:phiN">\[\begin{equation}
    \phi_N = J_a - R_L - G. \tag{1.2}
\end{equation}\]</span></p>
<p>With these changes, <a href="#eq:EB1">(1.1)</a> becomes</p>
<p><span class="math display" id="eq:EB2">\[\begin{equation}
    \phi_N - H - \lambda E = 0. \tag{1.3}
\end{equation}\]</span></p>
<p>In other words, <span class="math inline">\(\phi_N\)</span> is the net energy available to the crop for driving
transpiration and sensible heat loss.</p>
<p>The terms <span class="math inline">\(H\)</span> and <span class="math inline">\(E\)</span> are related to the conductance of heat and water vapor
from the canopy to the ambient environment. In fact, they can be both be
expressed using one-dimensional diffusion equations:</p>
<p><span class="math display" id="eq:H">\[\begin{equation}
    H = \rho c_p \left( T_l - T_a \right) g_H \tag{1.4}
\end{equation}\]</span></p>
<p>and</p>
<p><span class="math display" id="eq:E">\[\begin{equation}
    E = \left(\rho_{vl} - \rho_{va} \right) g_W, \tag{1.5}
\end{equation}\]</span></p>
<p>where <span class="math inline">\(\rho\)</span> is the density of dry air (kg m<span class="math inline">\(^{-3}\)</span>), <span class="math inline">\(c_p\)</span> is the specific heat
capacity of dry air (J kg<span class="math inline">\(^{-1}\)</span> K<span class="math inline">\(^{-1}\)</span>), <span class="math inline">\(T_a\)</span> and <span class="math inline">\(T_l\)</span> are the temperatures
of the ambient air and the leaves in canopy, respectively (K), <span class="math inline">\(\rho_{va}\)</span> and
<span class="math inline">\(\rho_{vl}\)</span> are the water vapor densities in the ambient air and within the
leaves, respectively (kg water m<span class="math inline">\(^{-3}\)</span>), and <span class="math inline">\(g_H\)</span> and <span class="math inline">\(g_W\)</span> are the
conductances to heat and water vapor (m s<span class="math inline">\(^{-1}\)</span>). Note that temperatures are
expressed in K here to ensure that the product <span class="math inline">\(\rho c_p T\)</span> is an energy density
with units J m<span class="math inline">\(^{-3}\)</span> (even though the temperature difference <span class="math inline">\(T_l - T_a\)</span> is
numerically identical whether K or <span class="math inline">\(^{\deg}\)</span>C are used for the temperatures).
Thus, both Equation <a href="#eq:H">(1.4)</a> and <a href="#eq:E">(1.5)</a> express a flux density as the
product of a conductance and a density gradient.</p>
<p>For a healthy leaf with sufficient access to water, in an environment with
reasonably low vapor pressure deficit, the air in its intercellular spaces is
close to full saturation <span class="citation">(<a href="#ref-wong_humidity_2022">Wong et al. 2022</a>)</span>. Thus, here we will make a
simplifying assumption that <span class="math inline">\(\rho_{vl} = \rho_{sat}(T_l)\)</span>, where
<span class="math inline">\(\rho_{sat}(T_l)\)</span> is the saturation water vapor density at the leaf temperature.
With this assumption, Equation <a href="#eq:E">(1.5)</a> can be expressed as</p>
<p><span class="math display" id="eq:E2">\[\begin{equation}
    E = \left[ \rho_{sat}(T_l) - \rho_{va} \right] g_W. \tag{1.6}
\end{equation}\]</span></p>
<p>Combining Equations <a href="#eq:EB2">(1.3)</a>, <a href="#eq:H">(1.4)</a>, and <a href="#eq:E2">(1.6)</a>, we can now
express the energy balance requirement as</p>
<p><span class="math display" id="eq:EB3">\[\begin{equation}
    \phi_N - \rho c_p \left( T_l - T_a \right) g_H -
        \lambda \left[ \rho_{sat}(T_l) - \rho_{va} \right] g_W = 0. \tag{1.7}
\end{equation}\]</span></p>
<p>This is a powerful equation because all of its terms either (i) can be taken as
constant for a given set of environmental conditions or (ii) have a known
dependence on the leaf temperature. Because of this, we can consider Equation
<a href="#eq:EB3">(1.7)</a> as a way to calculate the temperature of leaves in the canopy.
Once <span class="math inline">\(T_l\)</span> is known, Equation <a href="#eq:E2">(1.6)</a> can be used to calculate the
transpiration rate <span class="math inline">\(E\)</span>. Often this is the main goal of an energy balance
calculation, since the transpiration rate determines crop water use.</p>
<p>However, Equation <a href="#eq:EB3">(1.7)</a> cannot be solved analytically as it is written.
One main option is to solve it using a numerical approach, while another is to
approximate some of its terms in a way that enables an analytical expression for
<span class="math inline">\(T_l\)</span> and <span class="math inline">\(E\)</span>. The following sections will discuss different approaches to this
problem with varying levels of complexity.</p>
</div>
<div class="section level2" number="2">
<h2 id="pmthornley">
<span class="header-section-number">2</span> A Penman-Monteith Equation<a class="anchor" aria-label="anchor" href="#pmthornley"></a>
</h2>
<p>Here we continue following Chapter 12 of <span class="citation">Thornley and Johnson (<a href="#ref-thornley_plant_1990">1990</a>)</span>, which
derives analytical expressions for <span class="math inline">\(T_l\)</span> and <span class="math inline">\(E\)</span> based on energy balance
(Equation <a href="#eq:EB3">(1.7)</a>). In this approach, we make a few more assumptions:</p>
<ul>
<li><p>We treat the diffusion path for water vapor as consisting of two sequential
components: (i) diffusion from the intercellular spaces across the stomata to
the leaf surfaces (with conductance <span class="math inline">\(g_c\)</span>) and (ii) diffusion from the leaf
surfaces across the boundary layer to the bulk atmosphere (with conductance
<span class="math inline">\(g_a\)</span>).</p></li>
<li><p>We assume that the flows of water vapor and heat across the boundary
layer are driven by the same mechanical processes.</p></li>
<li><p>We assume that <span class="math inline">\(\phi_N\)</span>, <span class="math inline">\(g_a\)</span>, and <span class="math inline">\(g_c\)</span> do not depend on <span class="math inline">\(T_l\)</span>.</p></li>
<li><p>We assume that the temperature difference between the ambient air and the
leaves in the canopy (<span class="math inline">\(\Delta T = T_l - T_a\)</span>) is small.</p></li>
</ul>
<p>When <span class="math inline">\(\Delta T\)</span> is small, it is possible to linearize the equation for
saturation water vapor density <span class="math inline">\(\rho_{sat}(T)\)</span>. This is an approach first taken
by Penman. To do this, we first express <span class="math inline">\(\rho_{sat}(T_l)\)</span> as a
<a href="https://en.wikipedia.org/wiki/Taylor_series" class="external-link">Taylor series</a> centered on <span class="math inline">\(T_a\)</span>:</p>
<p><span class="math display">\[\begin{equation}
    \rho_{sat}(T_l) = \rho_{sat}(T_a) +
        \frac{d \rho_{sat}}{d T} \bigg\rvert_{T_a} \cdot \Delta T +
        \frac{1}{2!} \cdot \frac{d^2 \rho_{sat}}{d T^2} \bigg\rvert_{T_a} \cdot \left( \Delta T \right)^2 + ...
\end{equation}\]</span></p>
<p>If <span class="math inline">\(\Delta T\)</span> is small, then <span class="math inline">\((\Delta T)^2\)</span> is even smaller, and we can consider
it and any higher-order terms to be negligable. In this case, we can keep just
the first two terms of the Taylor series:</p>
<p><span class="math display" id="eq:linearRho">\[\begin{equation}
    \rho_{sat}(T_l) \approx \rho_{sat}(T_a) + s \Delta T \tag{2.1},
\end{equation}\]</span></p>
<p>where <span class="math inline">\(s = \frac{d \rho_{sat}}{d T} \bigg\rvert_{T_a}\)</span> is the slope of
<span class="math inline">\(\rho_{sat}(T)\)</span> at <span class="math inline">\(T = T_a\)</span>. With this simplification, Equation <a href="#eq:E2">(1.6)</a>
becomes</p>
<p><span class="math display" id="eq:E3">\[\begin{equation}
    E = \left[ \rho_{sat}(T_a) + s \left( \Delta T \right) - \rho_{va} \right] g_W =
        \left( \Delta \rho_{va} + s \Delta T \right) g_W \tag{2.2}
\end{equation}\]</span></p>
<p>where <span class="math inline">\(\Delta \rho_{va} = \rho_{sat}(T_a) - \rho_{va}\)</span> is the vapor density
deficit of the ambient air.</p>
<p>Because the stomata and boundary layer are in series, the total conductance to
water vapor (<span class="math inline">\(g_W\)</span>) is related to <span class="math inline">\(g_a\)</span> and <span class="math inline">\(g_c\)</span> according to</p>
<p><span class="math display" id="eq:gW">\[\begin{equation}
    \frac{1}{g_W} = \frac{1}{g_a} + \frac{1}{g_c}, \tag{2.3}
\end{equation}\]</span></p>
<p>Additionally, because the same mechanisms of conduction and convection drive the
flow of both water vapor and heat in the boundary layer, these conductances are
identical:</p>
<p><span class="math display" id="eq:gH">\[\begin{equation}
    g_H = g_a. \tag{2.4}
\end{equation}\]</span></p>
<p>Combining Equations <a href="#eq:EB3">(1.7)</a>, <a href="#eq:linearRho">(2.1)</a>, <a href="#eq:gW">(2.3)</a>, and
<a href="#eq:gH">(2.4)</a>, we can arrive at an expression of conservation of energy for a
crop canopy where only water vapor conductances are used:</p>
<p><span class="math display" id="eq:EB4">\[\begin{equation}
    \phi_N - \rho c_p \Delta T g_a -
        \frac{\lambda \left( \Delta \rho_{va} + s \Delta T \right)}{1 / g_a + 1 / g_c} = 0. \tag{2.5}
\end{equation}\]</span></p>
<p>These may not look simple. Nevertheless, with some algebra, Equation
<a href="#eq:EB4">(2.5)</a> can be solved for the temperature difference <span class="math inline">\(\Delta T\)</span>:</p>
<p><span class="math display" id="eq:DT1">\[\begin{equation}
    \Delta T = \frac{\phi_N \left( 1 / g_a + 1 / g_c \right) - \lambda \Delta \rho_{va}}{\lambda \left[ s + \gamma \left( 1 + g_a / g_c \right) \right]} \tag{2.6}
\end{equation}\]</span></p>
<p>where <span class="math inline">\(\gamma = \frac{\rho c_p}{\lambda}\)</span> is the “psychrometric parameter.” This
is Equation 14.11e in <span class="citation">Thornley and Johnson (<a href="#ref-thornley_plant_1990">1990</a>)</span>. Note that by assumption, everything
on the right-hand side is independent of the leaf temperature. Values of <span class="math inline">\(s\)</span>,
<span class="math inline">\(\rho\)</span>, <span class="math inline">\(c_p\)</span>, etc can be found in reference tables, so if values of <span class="math inline">\(\phi_N\)</span>,
<span class="math inline">\(g_a\)</span>, etc, are known or can be estimated, then Equation <a href="#eq:DT1">(2.6)</a> can be
used to calculate <span class="math inline">\(\Delta T\)</span> (and hence <span class="math inline">\(T_l\)</span>). It can also be plugged in to
Equation <a href="#eq:E3">(2.2)</a> to calculate the canopy transpiration rate <span class="math inline">\(E\)</span>:</p>
<p><span class="math display" id="eq:PM1">\[\begin{equation}
    E = \frac{s \phi_N + \lambda \gamma g_a \Delta \rho_{va}}{\lambda \left[ s + \gamma \left(1 + g_a / g_c \right) \right]}, \tag{2.7}
\end{equation}\]</span></p>
<p>This is Equation 14.4k from <span class="citation">Thornley and Johnson (<a href="#ref-thornley_plant_1990">1990</a>)</span>, where it is described as “the
Penman-Monteith equation.” However, just one page later, <span class="citation">Thornley and Johnson (<a href="#ref-thornley_plant_1990">1990</a>)</span>
gives an alternate version (Equation 14.5d). As it turns out, there are many
different equations referred to as “the Penman-Monteith equation” throughout
textbooks and the plant physiology literature. Thus, we prefer to call it “a
Penman-Monteith equation” to indicate it is just one example from a group of
potential Penman-Monteith equations. In the next section, we will discuss
another version.</p>
</div>
<div class="section level2" number="3">
<h2 id="pmcampbell">
<span class="header-section-number">3</span> Another Penman-Monteith Equation<a class="anchor" aria-label="anchor" href="#pmcampbell"></a>
</h2>
<p>The assumptions given at the start of the <a href="#pmthornley">previous section</a> are
not the only way to build analytical expressions for <span class="math inline">\(\Delta T\)</span> and <span class="math inline">\(E\)</span> from
Equation <a href="#eq:EB3">(1.7)</a>. In fact, a different approach can be found in Chapter 14
of <span class="citation">Campbell and Norman (<a href="#ref-campbell_introduction_1998">1998</a>)</span>. Here we make some alternate assumptions:</p>
<ul>
<li><p>We assume that <span class="math inline">\(J_a\)</span> and <span class="math inline">\(G\)</span> do not depend on leaf temperature, but we use
the <a href="https://en.wikipedia.org/wiki/Stefan%E2%80%93Boltzmann_law" class="external-link">Stefan-Boltzmann law</a>
to calculate <span class="math inline">\(R_L\)</span> from <span class="math inline">\(T_l\)</span>.</p></li>
<li><p>We assume that <span class="math inline">\(g_H\)</span> and <span class="math inline">\(g_W\)</span> do not depend on leaf temperature.</p></li>
<li><p>We assume that the temperature difference between the ambient air and the
leaves in the canopy (<span class="math inline">\(\Delta T = T_l - T_a\)</span>) is small.</p></li>
</ul>
<p>Applying the Stefan-Boltzmann law, we now have an expression for <span class="math inline">\(R_L\)</span>:</p>
<p><span class="math display">\[\begin{equation}
    R_L = \epsilon_s \sigma T_l^4,
\end{equation}\]</span></p>
<p>where <span class="math inline">\(\epsilon_s\)</span> is the canopy surface emissivity and <span class="math inline">\(\sigma\)</span> is the
Stefan-Boltzmann constant.</p>
<p>Because <span class="math inline">\(\Delta T\)</span> is small, we can linearize the saturation water vapor density
as before (Equation <a href="#eq:linearRho">(2.1)</a>). We can also linearize <span class="math inline">\(R_L\)</span> by noting
that</p>
<p><span class="math display">\[\begin{equation}
    T_L^4 = (T_a + \Delta T)^4 = T_a^4 + 4 T_a^3 \Delta T +
        6 T_a^2 (\Delta T)^2 + 4 T_a (\Delta T)^3 + (\Delta T)^4.
\end{equation}\]</span></p>
<p>We can again neglect terms with <span class="math inline">\(\Delta T^2\)</span> or higher powers, yielding</p>
<p><span class="math display" id="eq:linearRL">\[\begin{equation}
    R_L \approx \epsilon_s \sigma \left( T_a^4 + 4 T_a^3 \Delta T \right) =
        \epsilon_s \sigma T_a^4 - \rho c_p \Delta T g_r, \tag{3.1}
\end{equation}\]</span></p>
<p>where <span class="math inline">\(g_r = 4 \epsilon_s \sigma T_a^3 / ( \rho c_p)\)</span> is a “radiative
conductance” with units m s<span class="math inline">\(^{-1}\)</span>. Substituing this linearization into Equation
<a href="#eq:phiN">(1.2)</a> yields</p>
<p><span class="math display" id="eq:newphilinear">\[\begin{equation}
    \phi_N = J_a - \epsilon_s \sigma T_a^4 - \rho c_p \Delta T g_r  - G, \tag{3.2}
\end{equation}\]</span></p>
<p>Combining Equations <a href="#eq:EB3">(1.7)</a>, <a href="#eq:linearRho">(2.1)</a>, and
<a href="#eq:newphilinear">(3.2)</a>, we have yet another a new version of the canopy energy
balance equation:</p>
<p><span class="math display">\[\begin{equation}
    J_a - \epsilon_s \sigma T_a^4 - \rho c_p \Delta T g_r  - G - \rho c_p \Delta T g_H -
        \lambda \left( \Delta \rho_{va} + s \Delta T \right) g_W = 0.
\end{equation}\]</span></p>
<p>This can also be written as</p>
<p><span class="math display" id="eq:EB5">\[\begin{equation}
    J_a - \epsilon_s \sigma T_a^4 - G - \rho c_p g_{Hr} \Delta T -
        \lambda \left( \Delta \rho_{va} + s \Delta T \right) g_W = 0, \tag{3.3}
\end{equation}\]</span></p>
<p>where <span class="math inline">\(g_{Hr} = g_r + g_H\)</span> is a combined conductance for radiation and heat.
This expression of energy balance can now be solved for <span class="math inline">\(\Delta T\)</span> to produce an
equation analgous to Equation <a href="#eq:DT1">(2.6)</a>:</p>
<p><span class="math display" id="eq:DT2">\[\begin{equation}
    \Delta T = \frac{\left( J_a - \epsilon_s \sigma T_a^4  - G \right) / g_W - \lambda \Delta \rho_{va}}{\lambda \left[ s + \gamma (g_{Hr} / g_W) \right]}. \tag{3.4}
\end{equation}\]</span></p>
<p>Equation <a href="#eq:DT2">(3.4)</a> can be substituted into Equation <a href="#eq:E3">(2.2)</a> to
calculate the canopy transpiration rate <span class="math inline">\(E\)</span>:</p>
<p><span class="math display" id="eq:PM2">\[\begin{equation}
    E = \frac{s \left( J_a - \epsilon_s \sigma T_a^4  - G \right) + \lambda \gamma g_{Hr} \Delta \rho_{va}}{\lambda \left[ s + \gamma (g_{Hr} / g_W) \right]}. \tag{3.5}
\end{equation}\]</span></p>
<p>This equation is analagous to, but different from, Equation <a href="#eq:PM1">(2.7)</a>.
Disregarding differences in notation, it is also identical to Equation 14.12
from <span class="citation">Campbell and Norman (<a href="#ref-campbell_introduction_1998">1998</a>)</span>, where it is described as follows:</p>
<blockquote>
<p>This is the well known and widely used Penman-Monteith equation for estimating
evapotranspiration from plant communities.</p>
</blockquote>
<p>Yet, it is substantially different from the Penman-Monteith equation given in
<span class="citation">Thornley and Johnson (<a href="#ref-thornley_plant_1990">1990</a>)</span> due to the different assumptions and linearizations made
while deriving it.</p>
</div>
<div class="section level2" number="4">
<h2 id="the-penman-monteith-approach">
<span class="header-section-number">4</span> The Penman-Monteith Approach<a class="anchor" aria-label="anchor" href="#the-penman-monteith-approach"></a>
</h2>
<p>Sections <a href="#pmthornley">2</a> and <a href="#pmcampbell">3</a> illustrate two possible ways to
make approximations that enable Equations <a href="#eq:EB3">(1.7)</a> and <a href="#eq:E2">(1.6)</a> to be
solved for <span class="math inline">\(T_l\)</span> and <span class="math inline">\(E\)</span>. However, there are many possible choices that could,
in principle, each lead to slightly different versions of the equations:</p>
<ul>
<li><p>Energy balance can be considered at the canopy or leaf scale.</p></li>
<li><p>Water vapor concentrations can be expressed as vapor densities, partial
pressures, or mole fractions.</p></li>
<li><p><span class="math inline">\(R_L\)</span> can be linearized or considered as a leaf-temperature-independent
component of <span class="math inline">\(\phi_N\)</span>.</p></li>
<li><p>The diffusion path for water vapor can be separated into distinct sequential
steps or treated as a single process.</p></li>
</ul>
<p>This list is not necessarily exhaustive, but serves to illustrate the idea that
there is not one single Penman-Monteith equation. However, each potential
version of the equation includes a linearization of <span class="math inline">\(p_{sat}(T_l)\)</span> and possibly
<span class="math inline">\(R_L(T_l)\)</span>, approximating each of these as a linear function of <span class="math inline">\(\Delta T\)</span>.
This linearization is what enables the energy balance equation to be solved for
<span class="math inline">\(T_l\)</span>. Thus, this “Penman-Monteith approach” is common to all of these equations
even when there are differences between the equations themselves.</p>
</div>
<div class="section level2" number="5">
<h2 id="energy-balance-in-biocro">
<span class="header-section-number">5</span> Energy Balance in BioCro<a class="anchor" aria-label="anchor" href="#energy-balance-in-biocro"></a>
</h2>
<p>In Sections <a href="#generalEB">1</a>, <a href="#pmthornley">2</a>, and <a href="#pmcampbell">3</a>, the
canopy transpiration rate <span class="math inline">\(E\)</span> depends on canopy-level conductances: <span class="math inline">\(g_H\)</span>,
<span class="math inline">\(g_W\)</span>, <span class="math inline">\(g_a\)</span>, <span class="math inline">\(g_c\)</span>, and <span class="math inline">\(g_r\)</span>. In practice, these conductances are difficult
to estimate <em>a priori</em> because they depend on gradients of wind speed, light
intensity, and other factors within a plant canopy. In BioCro, we take an
alternate approach where transpiration rates are estimated at the leaf level
and then scaled up to the canopy level. This enables us to use models for
leaf-level conductance (such as the Ball-Berry model for stomatal conductance)
and also to account for variations in key inputs like <span class="math inline">\(J_a\)</span> throughout the
canopy. In this framework, the total canopy transpiration rate is given by</p>
<p><span class="math display" id="eq:ECanopyInt">\[\begin{equation}
    E_{canopy} = \int_{\ell = 0}^{L} \left( E_{leaf}^{sunlit}(\ell) \cdot f_{sunlit}(\ell) +
        E_{leaf}^{shaded}(\ell) \cdot f_{shaded}(\ell) \right) d \ell, \tag{5.1}
\end{equation}\]</span></p>
<p>where <span class="math inline">\(E_{leaf}^{sunlit}(\ell)\)</span> and <span class="math inline">\(E_{leaf}^{shaded}(\ell)\)</span> are the
leaf-level transpiration rates per leaf area for sunlit and shaded
leaves at cumulative leaf area index (cLAI) <span class="math inline">\(\ell\)</span>, <span class="math inline">\(f_{sunlit}(\ell)\)</span> and
<span class="math inline">\(f_{shaded}(\ell)\)</span> are the fractions of sunlit and shaded leaf area at <span class="math inline">\(\ell\)</span>,
and <span class="math inline">\(L\)</span> is the total canopy leaf area index (LAI).</p>
<p>The equations derived above using the Penman-Monteith approach assume that <span class="math inline">\(g_W\)</span>
is independent of both leaf temperature and incident light intensity.
Realistically, this assumption is likely to be violated because stomatal
conductance changes dynamically with photosynthesis, which in turn changes
dynamically with leaf temperature and incident light intensity. There is also a
buoyancy component to boundary layer conductance that depends on leaf
temperature. The equations used to calculate these conductances are complex and
not readily amenable to the types of linearizations employed in the
Penman-Monteith approach. So, in BioCro, we take a hybrid approach to energy
balance where <span class="math inline">\(T_l\)</span> is varied iteratively to simultaneously determine <span class="math inline">\(g_W\)</span>,
<span class="math inline">\(T_l\)</span>, and <span class="math inline">\(E\)</span> using Equation <a href="#eq:DT1">(2.6)</a>. See the <code>leaf_energy_balance()</code>
function in BioCro’s <code>C++</code> code for more details.</p>
<p>Because <span class="math inline">\(E_{leaf}\)</span> is calculated numerically in BioCro, it is not possible to
obtain an analytical expression for <span class="math inline">\(E_{canopy}\)</span> using Equation
<a href="#eq:ECanopyInt">(5.1)</a>. Instead, the integral is approximated using a
<a href="https://en.wikipedia.org/wiki/Riemann_sum" class="external-link">Riemann sum</a>:</p>
<p><span class="math display" id="eq:ECanopySum">\[\begin{equation}
    E_{canopy} = \sum_{i = 0}^{N-1} \left( E_{leaf}^{sunlit}(\ell_i) \cdot f_{sunlit}(\ell_i) +
        E_{leaf}^{shaded}(\ell_i) \cdot f_{shaded}(\ell_i) \right) \cdot \frac{L}{N}. \tag{5.2}
\end{equation}\]</span></p>
<p>Here the cLAI interval <span class="math inline">\((0, L)\)</span> has been divided into <span class="math inline">\(N\)</span> sub-intervals of
equal width (<span class="math inline">\(L / N\)</span>) and <span class="math inline">\(\ell_i = (i + 0.5) \cdot L / N\)</span> is the midpoint of
the <span class="math inline">\(i^{th}\)</span> sub-interval.</p>
<p>Values of <span class="math inline">\(T_l\)</span> and <span class="math inline">\(E\)</span> calculated from energy balance are sensitive to the
conductances across the stomata and boundary layer. Yet, the boundary layer
conductance in particular is difficult to estimate because it depends on details
such as wind speed, leaf shape, and other factors that change dynamically in
realistic conditions and cannot be easily quantified. In BioCro, we consider the
flow of water vapor from the leaf’s intercellular spaces to the bulk air in the
atmosphere to consist of three sequential steps as the gas crosses the stomata,
the leaf boundary layer, and finally the canopy boundary layer. The latter two
conductances combine to form the overall boundary layer conductance:</p>
<p><span class="math display">\[\begin{equation}
    \frac{1}{g_b} = \frac{1}{g_{b,leaf}} + \frac{1}{g_{b,canopy}},
\end{equation}\]</span></p>
<p>where <span class="math inline">\(g_{b,leaf}\)</span> and <span class="math inline">\(g_{g,canopy}\)</span> are the conductances across the leaf and
canopy boundary layers.</p>
<p><span class="math inline">\(g_{b,leaf}\)</span> is calculated using a model described in <span class="citation">Nikolov et al. (<a href="#ref-nikolov_coupling_1995">1995</a>)</span>. It
treats the leaves in the canopy as individual flat objects in a moving air
stream, and considers free and forced convection, where free convection is
driven by wind and forced convection is driven by temperature gradients. In
BioCro, wind speed within the canopy is modeled as an exponential decay with the
cumulative leaf area index, and this depth-dependent wind speed is used to
calculate <span class="math inline">\(g_{b,leaf}\)</span>. Because of this, and a dependence on stomatal
conductance, <span class="math inline">\(g_{b,leaf}\)</span> changes throughout the canopy and is different for
sunlit and shaded leaves.</p>
<p>On the other hand, <span class="math inline">\(g_{b,canopy}\)</span> is calculated using a model described in
<span class="citation">Thornley and Johnson (<a href="#ref-thornley_plant_1990">1990</a>)</span>. It treats the canopy as an infinitely wide rough surface
covering the ground, and only considers turbulent flow, so <span class="math inline">\(g_{b,canopy}\)</span>
primarily depends on the wind speed measured above the canopy. The model
equations predict <span class="math inline">\(g_{b,canopy} = 0\)</span> when wind speed is zero. In reality,
temperature-driven convection would occur at low wind speeds, setting a lower
limit for <span class="math inline">\(g_{b,canopy}\)</span> as in the model for <span class="math inline">\(g_{b,leaf}\)</span>. To account for this
in a simple way, a minimum value of <span class="math inline">\(g_{b,canopy}\)</span> is enforced in BioCro. The
minimum conductance is a parameter that can be varied by the user.
<span class="math inline">\(g_{b,canopy}\)</span> is the same for sunlit and shaded leaves at all depths within the
canopy.</p>
<p>The numeric technique used to solve for <span class="math inline">\(T_l\)</span> in BioCro (fixed-point iteration)
does not always converge to a reasonable solution. To prevent extremely high or
low leaf temperatures, <span class="math inline">\(\Delta T\)</span> is restricted to lie between -30<span class="math inline">\(^{\circ}\)</span>C
and 30<span class="math inline">\(^{\circ}\)</span>C. This restriction tends to be enforced only in unusual
situations where stomatal conductance is very low (and hence assimilation is low
as well), and thus has little impact on the overall result of a simulation.</p>
<div class="section level3" number="5.1">
<h3 id="biocro-examples">
<span class="header-section-number">5.1</span> BioCro Examples<a class="anchor" aria-label="anchor" href="#biocro-examples"></a>
</h3>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/biocro/biocro" class="external-link">BioCro</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://lattice.r-forge.r-project.org/" class="external-link">lattice</a></span><span class="op">)</span></span></code></pre></div>
<p>BioCro’s leaf-level energy balance model:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">transpiration_res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/modules.html">module_response_curve</a></span><span class="op">(</span></span>
<span>    <span class="st">'BioCro:leaf_evapotranspiration'</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>        absorbed_shortwave <span class="op">=</span> <span class="fl">250</span>,</span>
<span>        atmospheric_pressure <span class="op">=</span> <span class="fl">101325</span>,</span>
<span>        temp <span class="op">=</span> <span class="fl">25</span>,</span>
<span>        canopy_height <span class="op">=</span> <span class="fl">1</span>,</span>
<span>        leafwidth <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>        min_gbw_canopy <span class="op">=</span> <span class="fl">0.005</span>,</span>
<span>        rh <span class="op">=</span> <span class="fl">0.6</span>,</span>
<span>        wind_speed_height <span class="op">=</span> <span class="fl">10</span></span>
<span>    <span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></span><span class="op">(</span></span>
<span>        windspeed <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">2</span>, by <span class="op">=</span> <span class="fl">0.005</span><span class="op">)</span>,</span>
<span>        Gs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.05</span>, <span class="fl">0.1</span>, <span class="fl">0.2</span>, <span class="fl">0.4</span>, <span class="fl">0.8</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/lattice/man/xyplot.html" class="external-link">xyplot</a></span><span class="op">(</span></span>
<span>    <span class="va">TransR</span> <span class="op">~</span> <span class="va">windspeed</span>,</span>
<span>    group <span class="op">=</span> <span class="va">Gs</span>,</span>
<span>    data <span class="op">=</span> <span class="va">transpiration_res</span>,</span>
<span>    type <span class="op">=</span> <span class="st">'l'</span>,</span>
<span>    auto <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    xlab <span class="op">=</span> <span class="st">'Wind speed (m / s)'</span>,</span>
<span>    ylab <span class="op">=</span> <span class="st">'Transpiration rate (mmol / m^2 / s)'</span>,</span>
<span>    ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">5</span><span class="op">)</span>,</span>
<span>    main <span class="op">=</span> <span class="st">'Transpiration rate for different\nstomatal conductances (mol / m^2 / s)'</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="energy_balance_files/figure-html/unnamed-chunk-3-1.png" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/lattice/man/xyplot.html" class="external-link">xyplot</a></span><span class="op">(</span></span>
<span>    <span class="va">leaf_temperature</span> <span class="op">~</span> <span class="va">windspeed</span>,</span>
<span>    group <span class="op">=</span> <span class="va">Gs</span>,</span>
<span>    data <span class="op">=</span> <span class="va">transpiration_res</span>,</span>
<span>    type <span class="op">=</span> <span class="st">'l'</span>,</span>
<span>    auto <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    xlab <span class="op">=</span> <span class="st">'Wind speed (m / s)'</span>,</span>
<span>    ylab <span class="op">=</span> <span class="st">'Leaf temperature (degrees C)'</span>,</span>
<span>    ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">100</span><span class="op">)</span>,</span>
<span>    main <span class="op">=</span> <span class="st">'Leaf temperature for different\nstomatal conductances (mol / m^2 / s)'</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="energy_balance_files/figure-html/unnamed-chunk-3-2.png" style="display: block; margin: auto;"></p>
<p>BioCro’s model for canopy boundary layer conductance:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">canopy_gbw_res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/modules.html">module_response_curve</a></span><span class="op">(</span></span>
<span>    <span class="st">'BioCro:canopy_gbw_thornley'</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>        min_gbw_canopy <span class="op">=</span> <span class="fl">0</span>,</span>
<span>        windspeed_height <span class="op">=</span> <span class="fl">10</span></span>
<span>    <span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></span><span class="op">(</span></span>
<span>        windspeed <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">2</span>, by <span class="op">=</span> <span class="fl">0.025</span><span class="op">)</span>,</span>
<span>        canopy_height <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">2</span>, by <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/lattice/man/xyplot.html" class="external-link">xyplot</a></span><span class="op">(</span></span>
<span>    <span class="va">gbw_canopy</span> <span class="op">~</span> <span class="va">windspeed</span>,</span>
<span>    group <span class="op">=</span> <span class="va">canopy_height</span>,</span>
<span>    data <span class="op">=</span> <span class="va">canopy_gbw_res</span>,</span>
<span>    type <span class="op">=</span> <span class="st">'l'</span>,</span>
<span>    auto <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    xlab <span class="op">=</span> <span class="st">'Wind speed (m / s)'</span>,</span>
<span>    ylab <span class="op">=</span> <span class="st">'Canopy boundary layer conductance (m / s)'</span>,</span>
<span>    ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.02</span><span class="op">)</span>,</span>
<span>    main <span class="op">=</span> <span class="st">'Canopy gbw for different canopy heights'</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="energy_balance_files/figure-html/unnamed-chunk-4-1.png" style="display: block; margin: auto;"></p>
<p>BioCro’s model for leaf boundary layer conductance:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">leaf_gbw_res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../../reference/modules.html">module_response_curve</a></span><span class="op">(</span></span>
<span>    <span class="st">'BioCro:leaf_gbw_nikolov'</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>        air_pressure <span class="op">=</span> <span class="fl">101325</span>,</span>
<span>        leafwidth <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>        temp <span class="op">=</span> <span class="fl">25</span>,</span>
<span>        leaf_temperature <span class="op">=</span> <span class="fl">26</span>,</span>
<span>        rh <span class="op">=</span> <span class="fl">0.6</span></span>
<span>    <span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></span><span class="op">(</span></span>
<span>        windspeed <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, by <span class="op">=</span> <span class="fl">0.005</span><span class="op">)</span>,</span>
<span>        Gs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.05</span>, <span class="fl">0.1</span>, <span class="fl">0.2</span>, <span class="fl">0.4</span>, <span class="fl">0.8</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/lattice/man/xyplot.html" class="external-link">xyplot</a></span><span class="op">(</span></span>
<span>    <span class="va">gbw_leaf</span> <span class="op">~</span> <span class="va">windspeed</span>,</span>
<span>    group <span class="op">=</span> <span class="va">Gs</span>,</span>
<span>    data <span class="op">=</span> <span class="va">leaf_gbw_res</span>,</span>
<span>    type <span class="op">=</span> <span class="st">'l'</span>,</span>
<span>    auto <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    xlab <span class="op">=</span> <span class="st">'Wind speed (m / s)'</span>,</span>
<span>    ylab <span class="op">=</span> <span class="st">'Leaf boundary layer conductance (m / s)'</span>,</span>
<span>    ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.02</span><span class="op">)</span>,</span>
<span>    main <span class="op">=</span> <span class="st">'Leaf gbw for different stomatal conductances\n(Gs; mol / m^2 / s)'</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="energy_balance_files/figure-html/unnamed-chunk-5-1.png" style="display: block; margin: auto;"></p>
</div>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-campbell_introduction_1998" class="csl-entry">
Campbell, Gaylon S., and John Norman. 1998. <em>An <span>Introduction</span> to <span>Environmental</span> <span>Biophysics</span></em>. 2nd ed. New York: Springer-Verlag. <a href="https://www.springer.com/gp/book/9780387949376" class="external-link">https://www.springer.com/gp/book/9780387949376</a>.
</div>
<div id="ref-nikolov_coupling_1995" class="csl-entry">
Nikolov, Nedialko T., William J. Massman, and Anna W. Schoettle. 1995. <span>“Coupling Biochemical and Biophysical Processes at the Leaf Level: An Equilibrium Photosynthesis Model for Leaves of <span>C3</span> Plants.”</span> <em>Ecological Modelling</em> 80 (2): 205–35. <a href="https://doi.org/10.1016/0304-3800(94)00072-P" class="external-link">https://doi.org/10.1016/0304-3800(94)00072-P</a>.
</div>
<div id="ref-thornley_plant_1990" class="csl-entry">
Thornley, John H. M., and I. R. Johnson. 1990. <em>Plant and <span>Crop</span> <span>Modelling</span>: <span>A</span> <span>Mathematical</span> <span>Approach</span> to <span>Plant</span> and <span>Crop</span> <span>Physiology</span></em>.
</div>
<div id="ref-wong_humidity_2022" class="csl-entry">
Wong, Suan Chin, Martin J. Canny, Meisha Holloway-Phillips, Hilary Stuart-Williams, Lucas A. Cernusak, Diego A. Márquez, and Graham D. Farquhar. 2022. <span>“Humidity Gradients in the Air Spaces of Leaves.”</span> <em>Nature Plants</em> 8 (8): 971–78. <a href="https://doi.org/10.1038/s41477-022-01202-1" class="external-link">https://doi.org/10.1038/s41477-022-01202-1</a>.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Justin M. McGrath, Edward B. Lochocki, Yufeng He, Scott W. Oswald, Scott Rohde, Deepak Jaiswal, Megan L. Matthews, Fernando E. Miguez, Stephen P. Long.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
